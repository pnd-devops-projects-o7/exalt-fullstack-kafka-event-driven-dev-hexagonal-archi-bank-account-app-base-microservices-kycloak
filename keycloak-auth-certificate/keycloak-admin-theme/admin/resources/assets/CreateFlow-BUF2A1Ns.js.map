{"version":3,"file":"CreateFlow-BUF2A1Ns.js","sources":["../../../../../../../src/authentication/form/CreateFlow.tsx"],"sourcesContent":["import type AuthenticationFlowRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/authenticationFlowRepresentation\";\nimport {\n  ActionGroup,\n  AlertVariant,\n  Button,\n  PageSection,\n} from \"@patternfly/react-core\";\nimport { FormProvider, useForm } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { FormSubmitButton, SelectControl } from \"@keycloak/keycloak-ui-shared\";\nimport { useAdminClient } from \"../../admin-client\";\nimport { useAlerts } from \"@keycloak/keycloak-ui-shared\";\nimport { FormAccess } from \"../../components/form/FormAccess\";\nimport { ViewHeader } from \"../../components/view-header/ViewHeader\";\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\nimport { toAuthentication } from \"../routes/Authentication\";\nimport { toFlow } from \"../routes/Flow\";\nimport { NameDescription } from \"./NameDescription\";\n\nconst TYPES = [\"basic-flow\", \"client-flow\"] as const;\n\nexport default function CreateFlow() {\n  const { adminClient } = useAdminClient();\n\n  const { t } = useTranslation();\n  const navigate = useNavigate();\n  const { realm } = useRealm();\n  const { addAlert } = useAlerts();\n  const form = useForm<AuthenticationFlowRepresentation>();\n  const { handleSubmit, formState } = form;\n\n  const onSubmit = async (formValues: AuthenticationFlowRepresentation) => {\n    const flow = { ...formValues, builtIn: false, topLevel: true };\n\n    try {\n      const { id } =\n        await adminClient.authenticationManagement.createFlow(flow);\n      addAlert(t(\"flowCreatedSuccess\"), AlertVariant.success);\n      navigate(\n        toFlow({\n          realm,\n          id: id!,\n          usedBy: \"notInUse\",\n        }),\n      );\n    } catch (error: any) {\n      addAlert(\n        t(\"flowCreateError\", {\n          error: error.response?.data?.errorMessage || error,\n        }),\n        AlertVariant.danger,\n      );\n    }\n  };\n\n  return (\n    <>\n      <ViewHeader titleKey=\"createFlow\" subKey=\"authenticationCreateFlowHelp\" />\n      <PageSection variant=\"light\">\n        <FormProvider {...form}>\n          <FormAccess\n            isHorizontal\n            role=\"manage-authorization\"\n            onSubmit={handleSubmit(onSubmit)}\n          >\n            <NameDescription />\n            <SelectControl\n              name=\"providerId\"\n              label={t(\"flowType\")}\n              labelIcon={t(\"topLevelFlowTypeHelp\")}\n              aria-label={t(\"selectFlowType\")}\n              controller={{ defaultValue: TYPES[0] }}\n              options={TYPES.map((type) => ({\n                key: type,\n                value: t(`top-level-flow-type.${type}`),\n              }))}\n            />\n            <ActionGroup>\n              <FormSubmitButton\n                formState={formState}\n                data-testid=\"create\"\n                allowInvalid\n                allowNonDirty\n              >\n                {t(\"create\")}\n              </FormSubmitButton>\n              <Button\n                data-testid=\"cancel\"\n                variant=\"link\"\n                component={(props) => (\n                  <Link {...props} to={toAuthentication({ realm })}></Link>\n                )}\n              >\n                {t(\"cancel\")}\n              </Button>\n            </ActionGroup>\n          </FormAccess>\n        </FormProvider>\n      </PageSection>\n    </>\n  );\n}\n"],"names":["TYPES","CreateFlow","adminClient","useAdminClient","t","useTranslation","navigate","useNavigate","realm","useRealm","addAlert","useAlerts","form","useForm","handleSubmit","formState","jsxs","Fragment","jsx","ViewHeader","PageSection","FormProvider","FormAccess","formValues","flow","id","AlertVariant","toFlow","error","NameDescription","SelectControl","type","ActionGroup","FormSubmitButton","Button","props","Link","toAuthentication"],"mappings":"qZAoBA,MAAMA,EAAQ,CAAC,aAAc,aAAa,EAE1C,SAAwBC,GAAa,CAC7B,KAAA,CAAE,YAAAC,GAAgBC,IAElB,CAAE,EAAAC,GAAMC,IACRC,EAAWC,IACX,CAAE,MAAAC,GAAUC,IACZ,CAAE,SAAAC,GAAaC,IACfC,EAAOC,IACP,CAAE,aAAAC,EAAc,UAAAC,CAAc,EAAAH,EA0BpC,OAEII,EAAAC,EAAA,CAAA,SAAA,CAAAC,EAACC,EAAW,CAAA,SAAS,aAAa,OAAO,+BAA+B,IACvEC,EAAY,CAAA,QAAQ,QACnB,SAACF,EAAAG,EAAA,CAAc,GAAGT,EAChB,SAAAI,EAACM,EAAA,CACC,aAAY,GACZ,KAAK,uBACL,SAAUR,EAhCH,MAAOS,GAAiD,CACvE,MAAMC,EAAO,CAAE,GAAGD,EAAY,QAAS,GAAO,SAAU,IAEpD,GAAA,CACF,KAAM,CAAE,GAAAE,CAAG,EACT,MAAMvB,EAAY,yBAAyB,WAAWsB,CAAI,EAC5Dd,EAASN,EAAE,oBAAoB,EAAGsB,EAAa,OAAO,EACtDpB,EACEqB,EAAO,CACL,MAAAnB,EACA,GAAAiB,EACA,OAAQ,UAAA,CACT,CAAA,QAEIG,EAAY,CACnBlB,EACEN,EAAE,kBAAmB,CACnB,MAAOwB,EAAM,UAAU,MAAM,cAAgBA,CAAA,CAC9C,EACDF,EAAa,MAAA,CAEjB,CAAA,CAWuC,EAE/B,SAAA,CAAAR,EAACW,EAAgB,EAAA,EACjBX,EAACY,EAAA,CACC,KAAK,aACL,MAAO1B,EAAE,UAAU,EACnB,UAAWA,EAAE,sBAAsB,EACnC,aAAYA,EAAE,gBAAgB,EAC9B,WAAY,CAAE,aAAcJ,EAAM,CAAC,CAAE,EACrC,QAASA,EAAM,IAAK+B,IAAU,CAC5B,IAAKA,EACL,MAAO3B,EAAE,uBAAuB2B,CAAI,EAAE,CAAA,EACtC,CAAA,CACJ,IACCC,EACC,CAAA,SAAA,CAAAd,EAACe,EAAA,CACC,UAAAlB,EACA,cAAY,SACZ,aAAY,GACZ,cAAa,GAEZ,WAAE,QAAQ,CAAA,CACb,EACAG,EAACgB,EAAA,CACC,cAAY,SACZ,QAAQ,OACR,UAAYC,GACVjB,EAACkB,EAAM,CAAA,GAAGD,EAAO,GAAIE,EAAiB,CAAE,MAAA7B,CAAM,CAAC,CAAG,CAAA,EAGnD,WAAE,QAAQ,CAAA,CACb,CAAA,EACF,CAAA,CAAA,GAEJ,CACF,CAAA,CACF,CAAA,CAAA,CAEJ"}