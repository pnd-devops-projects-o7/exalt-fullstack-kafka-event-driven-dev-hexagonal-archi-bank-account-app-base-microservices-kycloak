import{jsxs as I,jsx as i}from"react/jsx-runtime";import{s as m}from"./DataListItemRow-BUcm7LGX.js";import{useRef as N,useState as X,useMemo as Y}from"react";import{a as q,h as o,c0 as B,c1 as K,c2 as C,c3 as A,c4 as M,c5 as p,eq as V}from"./main-C047jAp3.js";function J({keyField:g,columns:u,data:f,actions:T,onDragFinish:y,...L}){const{t:h}=q(),s=N(null),[a,c]=X({draggedItemId:"",draggingToItemIndex:-1,dragging:!1,tempItemOrder:[""]}),b=Y(()=>f.map(e=>o(e,g)),[f]),O=e=>{e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",e.currentTarget.id);const t=e.currentTarget.id;e.currentTarget.classList.add(m.modifiers.ghostRow),e.currentTarget.setAttribute("aria-grabbed","true"),c({...a,draggedItemId:t,dragging:!0})},v=(e,t,r)=>{const n=e.indexOf(t);if(n===r)return e;const d=e.splice(n,1);return e.splice(r,0,d[0]),e},x=e=>{if(!s.current)return;const t=s.current,r=Array.from(t.children);if(!r.map(n=>n.id).every((n,d)=>n===e[d])){for(;t.firstChild;)t.removeChild(t.lastChild);e.forEach(n=>{t.appendChild(r.find(d=>d.id===n))})}},w=()=>{Array.from(s.current?.children||[]).forEach(e=>{e.classList.remove(m.modifiers.ghostRow),e.setAttribute("aria-grabbed","false")}),c({...a,draggedItemId:"",draggingToItemIndex:-1,dragging:!1})},E=e=>{D(e)||(x(b),c({...a,draggingToItemIndex:-1}))},D=e=>{const t=s.current.getBoundingClientRect();return e.clientX>t.x&&e.clientX<t.x+t.width&&e.clientY>t.y&&e.clientY<t.y+t.height},S=e=>{D(e)?y(a.draggedItemId,a.tempItemOrder):w()},R=e=>{e.preventDefault();const r=e.target.closest("tr");if(!r||s.current&&!s.current.contains(r)||r.id===a.draggedItemId)return null;{const n=r.id,d=Array.from(s.current?.children||[]).findIndex(l=>l.id===n);if(d!==a.draggingToItemIndex){const l=v(b,a.draggedItemId,d);x(l),c({...a,draggingToItemIndex:d,tempItemOrder:l})}}},$=e=>{const t=e.target;t.classList.remove(m.modifiers.ghostRow),t.setAttribute("aria-grabbed","false"),c({...a,draggedItemId:"",draggingToItemIndex:-1,dragging:!1})},j=e=>{if(e.thTooltipText)return{popover:i("div",{children:h(e.thTooltipText)}),ariaLabel:h(e.thTooltipText)}};return I(B,{"aria-label":"Draggable table",className:a.dragging?m.modifiers.dragOver:"",...L,children:[i(K,{children:I(C,{children:[i(A,{"aria-hidden":"true"}),u.map(e=>i(A,{info:j(e),width:e.width,modifier:"fitContent",children:h(e.displayKey||e.name)},e.name))]})}),i(M,{ref:s,onDragOver:R,onDrop:R,onDragLeave:E,children:f.map(e=>I(C,{id:o(e,g),draggable:!0,onDrop:S,onDragEnd:$,onDragStart:O,children:[i(p,{draggableRow:{id:`draggable-row-${o(e,g)}`}}),u.map(t=>i(p,{dataLabel:t.name,children:t.cellRenderer?t.cellRenderer(e):o(e,t.name)},`${o(e,g)}_${t.name}`)),T&&i(p,{isActionCell:!0,children:i(V,{items:T.map(({isActionable:t,...r})=>t?{...r,isDisabled:!t(e)}:r),rowData:e})})]},o(e,g)))})]})}export{J as D};
//# sourceMappingURL=DraggableTable-B53ph1aP.js.map
