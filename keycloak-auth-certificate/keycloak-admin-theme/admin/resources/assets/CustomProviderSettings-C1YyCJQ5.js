import{jsxs as l,jsx as e}from"react/jsx-runtime";import{a as I,Y as V,m as U,J as v,K as b,N as P,q as C,Q as f,u as x,b as E,j as H,$ as j,d as D,e as O,C as _,P as L,A as $,f as k,L as q,eZ as F,o as z,p as G,n as Q}from"./main-C047jAp3.js";import{D as R}from"./DynamicComponents-CCNvrlYx.js";import{F as B}from"./FormAccess-CEFqBG2E.js";import{u as J}from"./useParams-6mfeCu18.js";import{E as K}from"./ExtendedHeader-C154f5uH.js";import{S as W}from"./SettingsCache-Cd2AoNCe.js";import"react";import"react-dom";import"./ClientSelect-mboGti-R.js";import"./FileUpload-2t3HfN2b.js";import"./CodeEditor--AHMF_Ho.js";import"./copy-icon-D1BxihC2.js";import"./GroupPickerDialog-CRtxj-P-.js";import"./DataListItemRow-BUcm7LGX.js";import"./KeySelect-DvFB2tXI.js";import"./useToggle-K3Kx99tM.js";import"./MultiLineInput-lQlb7SN3.js";import"./AddRoleMappingModal-BqwO7G2x.js";import"./translationFormatter-CkqjPJdy.js";import"./useLocaleSort-O4LGWO8i.js";import"./ConfirmDialog-d09hGFUk.js";import"./filter-icon-BeqpAxqe.js";import"./ViewHeader-Y2Z8ln-o.js";import"./isEqual-deZv8OsO.js";const Y=()=>{const{t:r}=I(),a=V(),{control:o,watch:t}=a,d=t("config.fullSyncPeriod","-1"),c=t("config.changedSyncPeriod","-1");return l(U,{...a,children:[e(v,{label:r("periodicFullSync"),labelIcon:e(b,{helpText:r("periodicFullSyncHelp"),fieldLabelId:"periodicFullSync"}),fieldId:"kc-periodic-full-sync",hasNoPaddingTop:!0,children:e(P,{name:"config.fullSyncPeriod",defaultValue:"-1",control:o,render:({field:i})=>e(C,{id:"kc-periodic-full-sync","data-testid":"periodic-full-sync",onChange:(m,s)=>{i.onChange(s?"604800":"-1")},isChecked:i.value!=="-1",label:r("on"),labelOff:r("off"),"aria-label":r("periodicFullSync")})})}),d!=="-1"&&e(f,{name:"config.fullSyncPeriod",label:r("fullSyncPeriod"),labelIcon:r("fullSyncPeriodHelp"),type:"number",min:-1,defaultValue:"604800"}),e(v,{label:r("periodicChangedUsersSync"),labelIcon:e(b,{helpText:r("periodicChangedUsersSyncHelp"),fieldLabelId:"periodicChangedUsersSync"}),fieldId:"kc-periodic-changed-users-sync",hasNoPaddingTop:!0,children:e(P,{name:"config.changedSyncPeriod",defaultValue:"-1",control:o,render:({field:i})=>e(C,{id:"kc-periodic-changed-users-sync","data-testid":"periodic-changed-users-sync",onChange:(m,s)=>{i.onChange(s?"86400":"-1")},isChecked:i.value!=="-1",label:r("on"),labelOff:r("off"),"aria-label":r("periodicChangedUsersSync")})})}),c!=="-1"&&e(f,{name:"config.changedSyncPeriod",label:r("changedUsersSyncPeriod"),labelIcon:r("changedUsersSyncHelp"),type:"number",min:-1,defaultValue:"86400"})]})};function Ce(){const{adminClient:r}=x(),{t:a}=I(),{id:o,providerId:t}=J(),d=E(),c=H({mode:"onChange"}),{reset:i,setValue:m,handleSubmit:s,formState:{isDirty:w}}=c,{addAlert:N,addError:T}=j(),{realm:y,realmRepresentation:A}=D(),g=(O().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[]).find(n=>n.id===t);_(async()=>{if(o)return await r.components.findOne({id:o})},n=>{if(n)Q(n,m);else if(o)throw new Error(a("notFound"))},[]);const h=async n=>{const S=z({...n,config:Object.fromEntries(Object.entries(n.config||{}).map(([p,u])=>[p,Array.isArray(u)?u:[u]])),providerId:t,providerType:"org.keycloak.storage.UserStorageProvider",parentId:A?.id});try{o?await r.components.update({id:o},S):(await r.components.create(S),d(F({realm:y}))),i({...n}),N(a(o?"userProviderSaveSuccess":"createUserProviderSuccess"),G.success)}catch(p){T(o?"userProviderSaveError":"createUserProviderError",p)}};return l(U,{...c,children:[e(K,{provider:t,save:()=>s(h)()}),e(L,{variant:"light",children:l(B,{role:"manage-realm",isHorizontal:!0,className:"keycloak__user-federation__custom-form",onSubmit:s(h),children:[e(f,{name:"name",label:a("uiDisplayName"),labelIcon:a("uiDisplayNameHelp"),rules:{required:a("validateName")}}),e(R,{properties:g?.properties||[]}),g?.metadata.synchronizable&&e(Y,{}),e(W,{form:c,unWrap:!0}),l($,{children:[e(k,{isDisabled:!w,variant:"primary",type:"submit","data-testid":"custom-save",children:a("save")}),e(k,{variant:"link",component:n=>e(q,{...n,to:F({realm:y})}),"data-testid":"custom-cancel",children:a("cancel")})]})]})})]})}export{Ce as default};
//# sourceMappingURL=CustomProviderSettings-C1YyCJQ5.js.map
