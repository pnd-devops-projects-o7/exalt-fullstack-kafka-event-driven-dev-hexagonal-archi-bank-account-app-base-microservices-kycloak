import{jsxs as M,Fragment as I,jsx as e}from"react/jsx-runtime";import{u as k,b as K,a as x,$ as A,c as B,C as E,B as U,p as R,S as V,T as j,f as N,L as w,k as $,j as z,d as H,x as O,m as q,P as C,fk as T,fl as F}from"./main-C047jAp3.js";import{useState as d}from"react";import{R as G,u as J}from"./RoutableTabs-BpMBzAU0.js";import{U as Q,s as W}from"./UserFederationLdapForm-DzKzz11S.js";import{u as X}from"./ConfirmDialog-d09hGFUk.js";import{u as Y,m as Z}from"./useLocaleSort-O4LGWO8i.js";import{E as _}from"./ExtendedHeader-C154f5uH.js";import{a as P,b as D}from"./Tabs-Dt-AxIu8.js";import"react-dom";import"./PageHandler-BsZt2gxJ.js";import"./DynamicComponents-CCNvrlYx.js";import"./ClientSelect-mboGti-R.js";import"./FileUpload-2t3HfN2b.js";import"./CodeEditor--AHMF_Ho.js";import"./copy-icon-D1BxihC2.js";import"./GroupPickerDialog-CRtxj-P-.js";import"./DataListItemRow-BUcm7LGX.js";import"./KeySelect-DvFB2tXI.js";import"./useToggle-K3Kx99tM.js";import"./MultiLineInput-lQlb7SN3.js";import"./AddRoleMappingModal-BqwO7G2x.js";import"./translationFormatter-CkqjPJdy.js";import"./filter-icon-BeqpAxqe.js";import"./useParams-6mfeCu18.js";import"./constants-BclHbWtx.js";import"./FormAccess-CEFqBG2E.js";import"./SettingsCache-Cd2AoNCe.js";import"./ViewHeader-Y2Z8ln-o.js";import"./isEqual-deZv8OsO.js";const ee=({toDetail:i,...o})=>e(w,{to:i(o.id),children:o.name}),te=({toCreate:i,toDetail:o})=>{const{adminClient:s}=k(),n=K(),{t:r}=x(),{addAlert:f,addError:g}=A(),[p,h]=d(0),y=()=>h(p+1),[b,S]=d([]),m=Y(),{id:v}=B(),[c,l]=d();E(()=>s.components.find({parent:v,type:"org.keycloak.storage.ldap.mappers.LDAPStorageMapper"}),a=>{S(m(a.map(L=>({...L,name:L.name,type:L.providerId})),Z("name")))},[p]);const[u,t]=X({titleKey:r("deleteMappingTitle",{mapperId:c?.id}),messageKey:"deleteMappingConfirm",continueButtonLabel:"delete",continueButtonVariant:U.danger,onConfirm:async()=>{try{await s.components.del({id:c.id}),y(),f(r("mappingDeletedSuccess"),R.success),l(void 0)}catch(a){g("mappingDeletedError",a)}}});return M(I,{children:[e(t,{}),e(V,{loader:b,ariaLabelKey:"ldapMappersList",searchPlaceholderKey:"searchForMapper",toolbarItem:e(j,{children:e(N,{"data-testid":"add-mapper-btn",variant:"primary",component:a=>e(w,{...a,to:i}),children:r("addMapper")})}),actions:[{title:r("delete"),onRowClick:a=>{l(a),u()}}],columns:[{name:"name",cellRenderer:a=>e(ee,{...a,toDetail:o})},{name:"type"}],emptyState:e($,{message:r("emptyMappers"),instructions:r("emptyMappersInstructions"),primaryActionText:r("emptyPrimaryAction"),onPrimaryAction:()=>n(i)})},p)]})};function Ee(){const{adminClient:i}=k(),{t:o}=x(),s=z({mode:"onChange"}),{realm:n}=H(),{id:r}=B(),{addAlert:f,addError:g}=A(),[p,h]=d(),[y,b]=d(0),S=()=>b(t=>t+1);E(()=>i.components.findOne({id:r}),t=>{if(!t)throw new Error(o("notFound"));h(t),l(t)},[r,y]);const m=t=>J(T({realm:n,id:r,tab:t})),v=m("settings"),c=m("mappers"),l=t=>{s.reset(t),s.setValue("config.periodicChangedUsersSync",t.config?.changedSyncPeriod?.[0]!=="-1"),s.setValue("config.periodicFullSync",t.config?.fullSyncPeriod?.[0]!=="-1")},u=async t=>{try{await i.components.update({id:r},W(t)),f(o("userProviderSaveSuccess"),R.success),S()}catch(a){g("userProviderSaveError",a)}};return p?M(q,{...s,children:[e(_,{provider:"LDAP",noDivider:!0,editMode:p.config?.editMode,save:()=>s.handleSubmit(u)()}),e(C,{variant:"light",className:"pf-v5-u-p-0",children:M(G,{defaultLocation:T({realm:n,id:r,tab:"settings"}),isBox:!0,children:[e(P,{id:"settings",title:e(D,{children:o("settings")}),...v,children:e(C,{variant:"light",children:e(Q,{id:r,onSubmit:u})})}),e(P,{id:"mappers",title:e(D,{children:o("mappers")}),"data-testid":"ldap-mappers-tab",...c,children:e(te,{toCreate:F({realm:n,id:r,mapperId:"new"}),toDetail:t=>F({realm:n,id:r,mapperId:t})})})]})})]}):e(O,{})}export{Ee as default};
//# sourceMappingURL=UserFederationLdapSettings-s6oWmmPg.js.map
