import{jsx as e,jsxs as b,Fragment as R}from"react/jsx-runtime";import{u as E,a as C,$ as D,j as L,C as ne,M as ve,l as we,F as Me,m as U,A as K,f as v,B as O,n as le,o as oe,p as N,d as _,x as se,q as Z,r as B,s as Ie,v as Ce,w as Se,y as Te,z as Ve,E as Re,G as ee,H as $e,S as Ee,P as V,W as z,Q as W,I as Le,J as q,K as M,N as te,R as ce,O as de,U as Ue,V as Ke,X as _e,Y as Be,Z as je,_ as ue,a0 as Ge,a1 as me,a2 as ze,a3 as We,a4 as Ye,e as ke,a5 as Xe,a6 as Qe,T as xe,a7 as Je,a8 as Ze,a9 as et,aa as tt,ab as at,ac as it,ad as nt,ae as lt,af as ot,ag as st,ah as rt,ai as ct,aj as dt,ak as ut,al as pe,L as Ne,am as mt,k as pt,an as ht,ao as bt}from"./main-C047jAp3.js";import{useState as T,useEffect as Y,useMemo as Oe}from"react";import{u as yt}from"./ConfirmDialog-d09hGFUk.js";import{R as ft,u as At}from"./RoutableTabs-BpMBzAU0.js";import{V as gt}from"./ViewHeader-Y2Z8ln-o.js";import{u as De,m as Pt}from"./useLocaleSort-O4LGWO8i.js";import{u as ae}from"./useToggle-K3Kx99tM.js";import{C as vt,R as wt,D as It,B as Ct}from"./DuplicateFlowModal-Be_pXQ0m.js";import{D as St}from"./DraggableTable-B53ph1aP.js";import{D as Tt}from"./DynamicComponents-CCNvrlYx.js";import{T as Rt}from"./trash-icon-CWGekjFz.js";import{f as Et}from"./AddRoleMappingModal-BqwO7G2x.js";import{F as X}from"./FormAccess-CEFqBG2E.js";import{T as He}from"./TimeSelectorControl-BN61rXeQ.js";import{M as he}from"./MultiLineInput-lQlb7SN3.js";import{Q as _t}from"./question-circle-icon-CJxJ4SYK.js";import{T as kt,a as k,b as x}from"./Tabs-Dt-AxIu8.js";import{T as xt}from"./Trans-C8a1WrTl.js";import{s as Nt}from"./sortBy-o2QtVcO3.js";import"react-dom";import"./PageHandler-BsZt2gxJ.js";import"./useParams-6mfeCu18.js";import"./constants-BclHbWtx.js";import"./NameDescription-D_42Crli.js";import"./DataListItemRow-BUcm7LGX.js";import"./ClientSelect-mboGti-R.js";import"./FileUpload-2t3HfN2b.js";import"./CodeEditor--AHMF_Ho.js";import"./copy-icon-D1BxihC2.js";import"./GroupPickerDialog-CRtxj-P-.js";import"./KeySelect-DvFB2tXI.js";import"./translationFormatter-CkqjPJdy.js";import"./filter-icon-BeqpAxqe.js";import"./TimeSelector-kOMzNss2.js";const Ot=({requiredAction:i,onClose:n})=>{const{adminClient:l}=E(),{t}=C(),{addAlert:a,addError:r}=D(),[m,c]=T(),p=L(),{setValue:g,handleSubmit:h}=p,f=d=>{le(d||{},g)};ne(async()=>{const d=await l.authenticationManagement.getRequiredActionConfigDescription({alias:i.alias}),y=await l.authenticationManagement.getRequiredActionConfig({alias:i.alias});return d.properties=[...d.properties],{configDescription:d,config:y}},({configDescription:d,config:y})=>{c(d),f(y)},[]);const I=async d=>{const y=oe(d);try{await l.authenticationManagement.updateRequiredActionConfig({alias:i.alias},y),f(y),a(t("configSaveSuccess"),N.success),n()}catch(w){r("configSaveError",w)}};return e(ve,{variant:we.small,isOpen:!0,title:t("requiredActionConfig",{name:i.name}),onClose:n,children:b(Me,{id:"required-action-config-form",onSubmit:h(I),children:[e(U,{...p,children:e(Tt,{stringify:!0,properties:m?.properties||[]})}),b(K,{children:[e(v,{"data-testid":"save",variant:"primary",type:"submit",children:t("save")}),e(v,{"data-testid":"cancel",variant:O.link,onClick:n,children:t("cancel")}),b(v,{className:"pf-v5-u-ml-3xl","data-testid":"clear",variant:O.link,onClick:async()=>{await l.authenticationManagement.removeRequiredActionConfig({alias:i.alias}),p.reset({}),n()},children:[t("clear")," ",e(Rt,{})]})]})]})})},Dt=()=>{const{adminClient:i}=E(),{t:n}=C(),{addAlert:l,addError:t}=D(),[a,r]=T(),[m,c]=T(),[p,g]=T(0),h=()=>g(p+1),{realm:f}=_(),I=async()=>await(await Ie(`${Se(i.baseUrl)}admin/realms/${f}/ui-ext/authentication-management/required-actions`,{method:"GET",headers:Ce(await i.getAccessToken())})).json();ne(async()=>{const[s,A]=await Promise.all([I(),i.authenticationManagement.getUnregisteredRequiredActions()]);return[...s.map(o=>({name:o.name,enabled:o.enabled,defaultAction:o.defaultAction,data:o})),...A.map(o=>({name:o.name,enabled:!1,defaultAction:!1,data:o}))]},s=>r(s),[p]);const d=s=>!("alias"in s),y=async(s,A)=>{try{A in s?(s[A]=!s[A],delete s.configurable,await i.authenticationManagement.updateRequiredAction({alias:s.alias},s)):d(s)&&await i.authenticationManagement.registerRequiredAction({name:s.name,providerId:s.providerId}),h(),l(n("updatedRequiredActionSuccess"),N.success)}catch(o){t("updatedRequiredActionError",o)}},w=async(s,A)=>{try{const o=s.alias;for(let u=0;u<Math.abs(A);u++)A>0?await i.authenticationManagement.lowerRequiredActionPriority({alias:o}):await i.authenticationManagement.raiseRequiredActionPriority({alias:o});h(),l(n("updatedRequiredActionSuccess"),N.success)}catch(o){t("updatedRequiredActionError",o)}};return a?b(R,{children:[m&&e(Ot,{requiredAction:m,onClose:()=>c(void 0)}),e(St,{keyField:"name",onDragFinish:async(s,A)=>{const o=a.map(P=>P.name),u=A.indexOf(s),S=o.indexOf(s),H=a[S].data;if(!H.alias)return;const Q=u-S;w(H,Q)},columns:[{name:"name",displayKey:"action",width:50},{name:"enabled",displayKey:"enabled",cellRenderer:s=>e(Z,{id:`enable-${B(s.name)}`,label:n("on"),labelOff:n("off"),isChecked:s.enabled,onChange:()=>{y(s.data,"enabled")},"aria-label":B(s.name)}),width:20},{name:"default",displayKey:"setAsDefaultAction",thTooltipText:"authDefaultActionTooltip",cellRenderer:s=>e(Z,{id:`default-${B(s.name)}`,label:n("on"),isDisabled:!s.enabled,labelOff:s.enabled?n("off"):n("disabledOff"),isChecked:s.defaultAction,onChange:()=>{y(s.data,"defaultAction")},"aria-label":B(s.name)}),width:20},{name:"config",displayKey:"configure",cellRenderer:s=>s.data.configurable?e(v,{variant:"plain","aria-label":n("settings"),onClick:()=>c(s.data),children:e(vt,{})}):void 0,width:10}],data:a})]}):e(se,{})},Ht="_label_1u2bs_1",ie={label:Ht},J=({label:i})=>b(R,{children:[e(Ve,{className:ie.label})," ",i]}),Ft=({id:i,isSpecificClient:n,onClose:l})=>{const{adminClient:t}=E(),{t:a}=C(),r=async(m,c,p)=>(await Et(t,{id:i,type:n?"clients":"idp",first:m||0,max:c||10,search:p})).map(h=>({name:h}));return e(ve,{header:b(Re,{children:[e(ee,{component:$e.h1,children:a("flowUsedBy")}),e(ee,{children:a("flowUsedByDescription",{value:a(n?"clients":"identiyProviders")})})]}),variant:we.medium,isOpen:!0,onClose:l,actions:[e(v,{"data-testid":"cancel",id:"modal-cancel",onClick:l,children:a("close")},"cancel")],children:e(Ee,{loader:r,isPaginated:!0,ariaLabelKey:"usedBy",searchPlaceholderKey:"search",columns:[{name:"name"}]})})},qt=({authType:{id:i,usedBy:n}})=>{const{t:l}=C(),{realmRepresentation:t}=_(),[a,r]=ae(),m=Object.entries(t).find(c=>c[1]===n?.values[0])?.[0];return b(R,{children:[a&&e(Ft,{id:i,onClose:r,isSpecificClient:n?.type==="SPECIFIC_CLIENTS"}),(n?.type==="SPECIFIC_PROVIDERS"||n?.type==="SPECIFIC_CLIENTS")&&(n.values.length<=8?e(Te,{"aria-label":l("usedBy"),bodyContent:b("div",{children:[l("appliedBy"+(n.type==="SPECIFIC_CLIENTS"?"Clients":"Providers"))," ",n.values.map((c,p)=>b(R,{children:[e("strong",{children:c}),p<n.values.length-1?", ":""]}))]},`usedBy-${i}-${n.values}`),children:e(v,{variant:"link",className:ie.label,children:e(J,{label:l(`used.${n.type}`)})})},i):e(v,{variant:"link",className:ie.label,onClick:r,children:e(J,{label:l(`used.${n.type}`)})})),n?.type==="DEFAULT"&&e(J,{label:l(`flow.${wt.get(m)}`)}),!n?.type&&l("used.notInUse")]})},Mt=["poll","ping"],j=10,G=600,be=0,ye=600,Vt=({realm:i,realmUpdated:n})=>{const{adminClient:l}=E(),{t}=C(),a=L({mode:"onChange"}),{realm:r}=_(),{addAlert:m,addError:c}=D(),p=h=>le(h,a.setValue);Y(()=>p(i),[]);const g=async h=>{try{await l.realms.update({realm:r},oe(h));const f=await l.realms.findOne({realm:r});n(f),p(f),m(t("updateCibaSuccess"),N.success)}catch(f){c("updateCibaError",f)}};return e(V,{variant:"light",children:b(X,{role:"manage-realm",isHorizontal:!0,onSubmit:a.handleSubmit(g),children:[b(U,{...a,children:[e(z,{name:"attributes.cibaBackchannelTokenDeliveryMode",label:t("cibaBackchannelTokenDeliveryMode"),labelIcon:t("cibaBackchannelTokenDeliveryModeHelp"),options:Mt.map(h=>({key:h,value:t(`cibaBackhannelTokenDeliveryModes.${h}`)})),controller:{defaultValue:""}}),e(W,{name:"attributes.cibaExpiresIn",type:"number",min:j,max:G,label:t("cibaExpiresIn"),labelIcon:t("cibaExpiresInHelp"),rules:{min:{value:j,message:t("greaterThan",{value:j})},max:{value:G,message:t("lessThan",{value:G})},required:{value:!0,message:t("required")}}}),e(W,{name:"attributes.cibaInterval",type:"number",min:j,max:G,label:t("cibaInterval"),labelIcon:t("cibaIntervalHelp"),rules:{min:{value:be,message:t("greaterThan",{value:be})},max:{value:ye,message:t("lessThan",{value:ye})},required:{value:!0,message:t("required")}}}),e(z,{name:"attributes.cibaAuthRequestedUserHint",label:t("cibaAuthRequestedUserHint"),labelIcon:t("cibaAuthRequestedUserHintHelp"),options:["login_hint","id_token_hint","login_hint_token"],controller:{defaultValue:""},isDisabled:!0})]}),b(K,{children:[e(v,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!a.formState.isValid||!a.formState.isDirty,children:t("save")}),e(v,{"data-testid":"reload",variant:O.link,onClick:()=>p({...i}),children:t("reload")})]})]})})},F=["totp","hotp"],fe=["SHA1","SHA256","SHA512"],Ae=[6,8],$t=({realm:i,realmUpdated:n})=>{const{adminClient:l}=E(),{t}=C(),a=L({mode:"onChange",defaultValues:i}),{control:r,reset:m,handleSubmit:c,formState:{isValid:p,isDirty:g}}=a,{realm:h}=_(),{addAlert:f,addError:I}=D(),d=De(),y=Le({name:"otpPolicyType",control:r,defaultValue:F[0]}),w=o=>m(o);Y(()=>w(i),[]);const s=Oe(()=>{const o=(i.otpSupportedApplications??[]).map(u=>t(`otpSupportedApplications.${u}`));return d(o,u=>u)},[i.otpSupportedApplications]);return e(V,{variant:"light",children:e(X,{role:"manage-realm",isHorizontal:!0,onSubmit:c(async o=>{try{await l.realms.update({realm:h},o);const u=await l.realms.findOne({realm:h});n(u),w(u),f(t("updateOtpSuccess"),N.success)}catch(u){I("updateOtpError",u)}}),className:"keycloak__otp_policies_authentication__form",children:b(U,{...a,children:[e(q,{label:t("otpType"),labelIcon:e(M,{helpText:t("otpTypeHelp"),fieldLabelId:"otpType"}),hasNoPaddingTop:!0,children:e(te,{name:"otpPolicyType","data-testid":"otpPolicyType",defaultValue:F[0],control:r,render:({field:o})=>e(R,{children:F.map(u=>e(ce,{id:u,"data-testid":u,isChecked:o.value===u,name:"otpPolicyType",onChange:()=>o.onChange(u),label:t(`policyType.${u}`),className:"keycloak__otp_policies_authentication__policy-type"},u))})})}),e(z,{name:"otpPolicyAlgorithm",label:t("otpHashAlgorithm"),labelIcon:t("otpHashAlgorithmHelp"),options:fe.map(o=>({key:`Hmac${o}`,value:o})),controller:{defaultValue:`Hmac${fe[0]}`}}),e(q,{label:t("otpPolicyDigits"),labelIcon:e(M,{helpText:t("otpPolicyDigitsHelp"),fieldLabelId:"otpPolicyDigits"}),hasNoPaddingTop:!0,children:e(te,{name:"otpPolicyDigits","data-testid":"otpPolicyDigits",defaultValue:Ae[0],control:r,render:({field:o})=>e(R,{children:Ae.map(u=>e(ce,{id:`digit-${u}`,"data-testid":`digit-${u}`,isChecked:o.value===u,name:"otpPolicyDigits",onChange:()=>o.onChange(u),label:u,className:"keycloak__otp_policies_authentication__number-of-digits"},u))})})}),e(de,{name:"otpPolicyLookAheadWindow",label:t("lookAround"),labelIcon:t("lookAroundHelp"),controller:{defaultValue:1,rules:{min:0}}}),y===F[0]&&e(He,{name:"otpPolicyPeriod",label:t("otpPolicyPeriod"),labelIcon:t("otpPolicyPeriodHelp"),units:["second","minute"],controller:{defaultValue:30,rules:{min:1,max:{value:120,message:t("maxLength",{length:"2 "+t("minutes")})}}}}),y===F[1]&&e(de,{name:"otpPolicyInitialCounter",label:t("initialCounter"),labelIcon:t("initialCounterHelp"),controller:{defaultValue:30,rules:{min:1,max:120}}}),e(q,{label:t("supportedApplications"),labelIcon:e(M,{helpText:t("supportedApplicationsHelp"),fieldLabelId:"supportedApplications"}),children:e("span",{"data-testid":"supportedApplications",children:e(Ue,{children:s.map(o=>e(Ke,{isReadOnly:!0,children:o},o))})})}),y===F[0]&&e(_e,{name:"otpPolicyCodeReusable",label:t("otpPolicyCodeReusable"),labelIcon:t("otpPolicyCodeReusableHelp"),labelOn:t("on"),labelOff:t("off")}),b(K,{children:[e(v,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!p||!g,children:t("save")}),e(v,{"data-testid":"reload",variant:O.link,onClick:()=>m({...i}),children:t("reload")})]})]})})})},Lt=({policy:{id:i,configType:n,defaultValue:l,displayName:t},onRemove:a})=>{const{t:r}=C(),{control:m,register:c,formState:{errors:p}}=Be(),g=p[i];return b(q,{label:t,fieldId:i,isRequired:!0,labelIcon:e(M,{helpText:r(`passwordPoliciesHelp.${i}`),fieldLabelId:i}),children:[b(je,{children:[b(ue,{isFilled:!0,children:[n&&n!=="int"&&e(Ge,{id:i,"data-testid":i,...c(i,{required:!0}),defaultValue:l,validated:g?me.error:me.default}),n==="int"&&e(te,{name:i,defaultValue:Number.parseInt(l||"0"),control:m,render:({field:h})=>{const I=y=>h.onChange(Math.max(y,0)),d=Number(h.value);return e(ze,{id:i,value:d,min:0,onPlus:()=>I(d+1),onMinus:()=>I(d-1),onChange:y=>{const w=Number(y.currentTarget.value);I(isNaN(w)?0:w)},className:"keycloak__policies_authentication__number-field"})}}),!n&&e(Z,{id:i,label:r("on"),labelOff:r("off"),isChecked:!0,isDisabled:!0,"aria-label":t})]}),e(ue,{children:e(v,{"data-testid":`remove-${i}`,variant:"link",className:"keycloak__policies_authentication__minus-icon",onClick:()=>a(i),"aria-label":r("remove"),children:e(We,{})})})]}),g&&e(Ye,{message:r("required")})]})},Fe=" and ",Ut=(i,n)=>i.map(l=>`${l.id}(${n[l.id]})`).join(Fe),Kt=(i,n)=>i.split(Fe).map(Bt).reduce((l,{id:t,value:a})=>{const r=n.find(m=>m.id===t);return r?l.concat({...r,value:a}):l},[]);function Bt(i){const n=i.indexOf("(");if(n===-1)return{id:i.trim()};const l=i.substring(0,n).trim(),t=i.lastIndexOf(")");if(t===-1)return{id:l};const a=i.substring(n+1,t).trim();return{id:l,value:a}}const ge=({onSelect:i,selectedPolicies:n})=>{const{t:l}=C(),{passwordPolicies:t}=ke(),[a,r]=T(!1),m=Oe(()=>t?.filter(c=>n.find(p=>p.id===c.id)===void 0),[n]);return e(ot,{onSelect:(c,p)=>{i(p),r(!1)},toggle:c=>e(st,{ref:c,onClick:()=>r(!a),isExpanded:a,isDisabled:m?.length===0,style:{width:"300px"},"data-testid":"add-policy",children:l("addPolicy")}),isOpen:a,children:e(rt,{children:m?.map(c=>e(ct,{value:c,children:c.displayName},c.id))})})},jt=({realm:i,realmUpdated:n})=>{const{adminClient:l}=E(),{t}=C(),{passwordPolicies:a}=ke(),{addAlert:r,addError:m}=D(),{realm:c}=_(),[p,g]=T([]),h=o=>{g([...p,o]),d(o.id,o.defaultValue,{shouldDirty:!0})},f=L({defaultValues:{}}),{handleSubmit:I,setValue:d,reset:y,formState:{isDirty:w}}=f,s=o=>{y();const u=Kt(o.passwordPolicy||"",a);u.forEach(S=>{d(S.id,S.value)}),g(u)};Y(()=>s(i),[]);const A=async o=>{const u={...i,passwordPolicy:Ut(p,o)};try{await l.realms.update({realm:c},u),n(u),s(u),r(t("updatePasswordPolicySuccess"),N.success)}catch(S){m("updatePasswordPolicyError",S)}};return b(V,{variant:"light",className:"pf-v5-u-p-0",children:[(p.length!==0||i.passwordPolicy)&&b(R,{children:[e(Xe,{children:e(Qe,{children:e(xe,{children:e(ge,{onSelect:h,selectedPolicies:p})})})}),e(Je,{}),e(V,{variant:"light",children:e(U,{...f,children:b(X,{className:"keycloak__policies_authentication__form",role:"manage-realm",isHorizontal:!0,onSubmit:I(A),children:[p.map((o,u)=>e(Lt,{policy:o,onRemove:S=>{g(p.filter(H=>H.id!==S)),d(o.id,"",{shouldDirty:!0})}},`${o.id}-${u}`)),b(K,{children:[e(v,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!w,children:t("save")}),e(v,{"data-testid":"reload",variant:O.link,onClick:()=>s(i),children:t("reload")})]})]})})})]}),!p.length&&!i.passwordPolicy&&b(Ze,{"data-testid":"empty-state",variant:"lg",children:[e(et,{titleText:e(R,{children:t("noPasswordPolicies")}),icon:e(tt,{icon:at}),headingLevel:"h1"}),e(it,{children:t("noPasswordPoliciesInstructions")}),e(nt,{children:e(lt,{children:e(ge,{onSelect:h,selectedPolicies:[]})})})]})]})},Gt=["ES256","ES384","ES512","RS256","RS384","RS512","Ed25519","RS1"],zt=["not specified","none","indirect","direct"],Wt=["not specified","platform","cross-platform"],Yt=["not specified","Yes","No"],Xt=["not specified","required","preferred","discouraged"],$=({name:i,label:n,labelIcon:l,options:t,labelPrefix:a,isMultiSelect:r=!1})=>{const{t:m}=C();return e(z,{name:i,label:n,labelIcon:l,variant:r?"typeaheadMulti":"single",controller:{defaultValue:t[0]},options:t.map(c=>({key:c,value:a?m(`${a}.${c}`):c}))})},Pe=({realm:i,realmUpdated:n,isPasswordLess:l=!1})=>{const{adminClient:t}=E(),{t:a}=C(),{addAlert:r,addError:m}=D(),{realm:c}=_(),{enabled:p}=dt(),g=L({mode:"onChange"}),{setValue:h,handleSubmit:f,formState:{isDirty:I}}=g,d=l?"webAuthnPolicyPasswordless":"webAuthnPolicy",y=s=>le(s,h);Y(()=>y(i),[]);const w=async s=>{const A=oe(s);try{await t.realms.update({realm:c},A),n(A),y(A),r(a("webAuthnUpdateSuccess"),N.success)}catch(o){m("webAuthnUpdateError",o)}};return b(V,{variant:"light",children:[p&&e(Te,{bodyContent:a(`${d}FormHelp`),children:e(Re,{className:"keycloak__section_intro__help",children:b(ee,{children:[e(_t,{})," ",a("webauthnIntro")]})})}),b(X,{role:"manage-realm",isHorizontal:!0,onSubmit:f(w),className:"keycloak__webauthn_policies_authentication__form",children:[b(U,{...g,children:[e(W,{name:`${d}RpEntityName`,label:a("webAuthnPolicyRpEntityName"),labelIcon:a("webAuthnPolicyRpEntityNameHelp"),rules:{required:{value:!0,message:a("required")}}}),e($,{name:`${d}SignatureAlgorithms`,label:a("webAuthnPolicySignatureAlgorithms"),labelIcon:a("webAuthnPolicySignatureAlgorithmsHelp"),options:Gt,isMultiSelect:!0}),e(W,{name:`${d}RpId`,label:a("webAuthnPolicyRpId"),labelIcon:a("webAuthnPolicyRpIdHelp")}),e($,{name:`${d}AttestationConveyancePreference`,label:a("webAuthnPolicyAttestationConveyancePreference"),labelIcon:a("webAuthnPolicyAttestationConveyancePreferenceHelp"),options:zt,labelPrefix:"attestationPreference"}),e($,{name:`${d}AuthenticatorAttachment`,label:a("webAuthnPolicyAuthenticatorAttachment"),labelIcon:a("webAuthnPolicyAuthenticatorAttachmentHelp"),options:Wt,labelPrefix:"authenticatorAttachment"}),e($,{name:`${d}RequireResidentKey`,label:a("webAuthnPolicyRequireResidentKey"),labelIcon:a("webAuthnPolicyRequireResidentKeyHelp"),options:Yt,labelPrefix:"residentKey"}),e($,{name:`${d}UserVerificationRequirement`,label:a("webAuthnPolicyUserVerificationRequirement"),labelIcon:a("webAuthnPolicyUserVerificationRequirementHelp"),options:Xt,labelPrefix:"userVerify"}),e(He,{name:`${d}CreateTimeout`,label:a("webAuthnPolicyCreateTimeout"),labelIcon:a("webAuthnPolicyCreateTimeoutHelp"),units:["second","minute","hour"],controller:{defaultValue:0,rules:{min:0,max:{value:31536,message:a("webAuthnPolicyCreateTimeoutHint")}}}}),e(_e,{name:`${d}AvoidSameAuthenticatorRegister`,label:a("webAuthnPolicyAvoidSameAuthenticatorRegister"),labelIcon:a("webAuthnPolicyAvoidSameAuthenticatorRegisterHelp"),labelOn:a("on"),labelOff:a("off")}),e(q,{label:a("webAuthnPolicyAcceptableAaguids"),fieldId:"webAuthnPolicyAcceptableAaguids",labelIcon:e(M,{helpText:a("webAuthnPolicyAcceptableAaguidsHelp"),fieldLabelId:"webAuthnPolicyAcceptableAaguids"}),children:e(he,{name:`${d}AcceptableAaguids`,"aria-label":a("webAuthnPolicyAcceptableAaguids"),addButtonLabel:"addAaguids"})}),e(q,{label:a("webAuthnPolicyExtraOrigins"),fieldId:"webAuthnPolicyExtraOrigins",labelIcon:e(M,{helpText:a("webAuthnPolicyExtraOriginsHelp"),fieldLabelId:"webAuthnPolicyExtraOrigins"}),children:e(he,{name:`${d}ExtraOrigins`,"aria-label":a("webAuthnPolicyExtraOrigins"),addButtonLabel:"addOrigins"})})]}),b(K,{children:[e(v,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!I,children:a("save")}),e(v,{"data-testid":"reload",variant:O.link,onClick:()=>y(i),children:a("reload")})]})]})]})},Qt=()=>{const{adminClient:i}=E(),{t:n}=C(),[l,t]=T(1),{realm:a}=_(),[r,m]=T();return ne(async()=>{const c=await i.realms.findOne({realm:a});if(!c)throw new Error(n("notFound"));return c},c=>{m(c)},[]),r?b(kt,{activeKey:l,onSelect:(c,p)=>t(p),mountOnEnter:!0,unmountOnExit:!0,children:[e(k,{id:"passwordPolicy",eventKey:1,title:e(x,{children:n("passwordPolicy")}),children:e(jt,{realm:r,realmUpdated:m})}),e(k,{id:"otpPolicy",eventKey:2,title:e(x,{children:n("otpPolicy")}),children:e($t,{realm:r,realmUpdated:m})}),e(k,{id:"webauthnPolicy",eventKey:3,title:e(x,{children:n("webauthnPolicy")}),children:e(Pe,{realm:r,realmUpdated:m})}),e(k,{id:"webauthnPasswordlessPolicy",eventKey:4,title:e(x,{children:n("webauthnPasswordlessPolicy")}),children:e(Pe,{realm:r,realmUpdated:m,isPasswordLess:!0})}),e(k,{"data-testid":"tab-ciba-policy",eventKey:5,title:e(x,{children:n("cibaPolicy")}),children:e(Vt,{realm:r,realmUpdated:m})})]}):e(se,{})},Jt=({id:i,alias:n,usedBy:l,builtIn:t})=>{const{t:a}=C(),{realm:r}=_();return b(R,{children:[e(Ne,{to:ht({realm:r,id:i,usedBy:l?.type||"notInUse",builtIn:t?"builtIn":void 0}),children:n},`link-${i}`)," ",t&&e(bt,{children:a("buildIn")},`label-${i}`)]})};function Da(){const{adminClient:i}=E(),{t:n}=C(),{realm:l,realmRepresentation:t}=_(),[a,r]=T(0),m=()=>r(a+1),{addAlert:c,addError:p}=D(),g=De(),[h,f]=T(),[I,d]=ae(),[y,w]=ae(),s=async()=>{const re=await(await Ie(`${Se(i.baseUrl)}admin/realms/${l}/ui-ext/authentication-management/flows`,{method:"GET",headers:Ce(await i.getAccessToken())})).json();return re?Nt(g(re,Pt("alias")),qe=>qe.usedBy?.type):[]},A=P=>At(pe({realm:l,tab:P})),o=A("flows"),u=A("required-actions"),S=A("policies"),[H,Q]=yt({titleKey:"deleteConfirmFlow",children:b(xt,{i18nKey:"deleteConfirmFlowMessage",children:[" ",e("strong",{children:{flow:h?h.alias:""}}),"."]}),continueButtonLabel:"delete",continueButtonVariant:O.danger,onConfirm:async()=>{try{await i.authenticationManagement.deleteFlow({flowId:h.id}),m(),c(n("deleteFlowSuccess"),N.success)}catch(P){p("deleteFlowError",P)}}});return t?b(R,{children:[e(Q,{}),I&&e(It,{name:h?h.alias:"",description:h?.description,toggleDialog:d,onComplete:()=>{m(),d()}}),y&&e(Ct,{onClose:()=>{w(),m()},flowAlias:h?.alias}),e(gt,{titleKey:"titleAuthentication",subKey:"authenticationExplain",helpUrl:ut.authenticationUrl,divider:!1}),e(V,{variant:"light",className:"pf-v5-u-p-0",children:b(ft,{isBox:!0,defaultLocation:pe({realm:l,tab:"flows"}),children:[e(k,{"data-testid":"flows",title:e(x,{children:n("flows")}),...o,children:e(Ee,{loader:s,ariaLabelKey:"titleAuthentication",searchPlaceholderKey:"searchForFlow",toolbarItem:e(xe,{children:e(v,{component:P=>e(Ne,{...P,to:mt({realm:l})}),children:n("createFlow")})}),actionResolver:({data:P})=>[{title:n("duplicate"),onClick:()=>{d(),f(P)}},...P.usedBy?.type!=="DEFAULT"?[{title:n("bindFlow"),onClick:()=>{w(),f(P)}}]:[],...!P.builtIn&&!P.usedBy?[{title:n("delete"),onClick:()=>{f(P),H()}}]:[]],columns:[{name:"alias",displayKey:"flowName",cellRenderer:P=>e(Jt,{...P})},{name:"usedBy",displayKey:"usedBy",cellRenderer:P=>e(qt,{authType:P})},{name:"description",displayKey:"description"}],emptyState:e(pt,{message:n("emptyEvents"),instructions:n("emptyEventsInstructions")})},a)}),e(k,{"data-testid":"requiredActions",title:e(x,{children:n("requiredActions")}),...u,children:e(Dt,{})}),e(k,{"data-testid":"policies",title:e(x,{children:n("policies")}),...S,children:e(Qt,{})})]})})]}):e(se,{})}export{Da as default};
//# sourceMappingURL=AuthenticationSection-7dTapcuh.js.map
