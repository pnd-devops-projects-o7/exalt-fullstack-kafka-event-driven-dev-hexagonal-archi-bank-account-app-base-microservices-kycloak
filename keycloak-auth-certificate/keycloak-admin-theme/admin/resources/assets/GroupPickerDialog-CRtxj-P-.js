import{jsx as s,jsxs as D}from"react/jsx-runtime";import{aq as q,ar as S,dl as Y,bk as Z,u as ee,a as z,C as ae,M as te,l as F,f as A,au as se,dz as ie,dA as T,k as V,as as ne}from"./main-C047jAp3.js";import*as v from"react";import{useState as h,Fragment as le}from"react";import{s as E,d as ce,D as oe,a as re,b as de,c as me}from"./DataListItemRow-BUcm7LGX.js";const J=e=>{var{children:l,className:o,visibility:c,id:p,"aria-label":k,"aria-labelledby":u,isPlainButtonAction:r}=e,d=q(e,["children","className","visibility","id","aria-label","aria-labelledby","isPlainButtonAction"]);return v.createElement("div",Object.assign({className:S(E.dataListItemAction,Y(c,E),o)},d),r?v.createElement("div",{className:S(E.dataListAction)},l):l)};J.displayName="DataListAction";const _=e=>{var{className:l="",onChange:o=(f,n)=>{},isValid:c=!0,isDisabled:p=!1,isChecked:k=!1,checked:u=!1,defaultChecked:r,otherControls:d=!1}=e,i=q(e,["className","onChange","isValid","isDisabled","isChecked","checked","defaultChecked","otherControls"]);const m=v.createElement("div",{className:S(E.dataListCheck)},v.createElement("input",Object.assign({},i,{type:"checkbox",onChange:f=>o(f,f.currentTarget.checked),"aria-invalid":!c,disabled:p},[!0,!1].includes(r)&&{defaultChecked:r},![!0,!1].includes(r)&&{checked:k||u})));return v.createElement(v.Fragment,null,!d&&v.createElement("div",{className:S(E.dataListItemControl,l)},m),d&&m)};_.displayName="DataListCheck";const he=({group:{path:e},onMouseEnter:l,...o})=>{const[c,p]=h(""),u=s("span",{onMouseEnter:r=>{p(e),l?.(r)},...o,children:e});return c!==""?s(Z,{content:c,isVisible:!0,children:u}):u},fe=({id:e,type:l,filterGroups:o,text:c,canBrowse:p=!0,isMove:k=!1,onClose:u,onConfirm:r})=>{const{adminClient:d}=ee(),{t:i}=z(),[m,f]=h([]),[n,g]=h([]),[x,H]=h([]),[P,K]=h(""),[Q,W]=h([]),[G,y]=h(),[b,R]=h(!1),[N,I]=h(10),[w,L]=h(0),[X,j]=h(0),B=()=>n[n.length-1];ae(async()=>{let a,t,M;if(G){if(!n.map(({id:$})=>$).includes(G)&&(a=await d.groups.findOne({id:G}),!a))throw new Error(i("notFound"));const C={first:w,max:N,parentId:G};t=await d.groups.listSubGroups(C)}else{const C={first:w,max:N+1};b&&(C.search=P),t=await d.groups.find(C)}return e&&(M=await d.users.listGroups({id:e})),{group:a,groups:t,existingUserGroups:M}},async({group:a,groups:t,existingUserGroups:M})=>{W(M||[]),a&&(g([...n,a]),j(a.subGroupCount)),t.forEach(C=>{C.checked=!!m.find($=>$.id===C.id)}),H(t),(b||!G)&&j(t.length)},[G,P,w,N]);const O=a=>[...Q.map(t=>t.id),...(o||[]).map(t=>t.id)].some(t=>t===a?.id);return s(te,{variant:b?F.medium:F.small,title:i(c.title,{group1:o?.[0]?.name,group2:n.length?B().name:i("root")}),isOpen:!0,onClose:u,actions:[s(A,{"data-testid":`${c.ok}-button`,variant:"primary",form:"group-form",onClick:()=>{r(l==="selectMany"?m:n.length?[B()]:void 0)},isDisabled:l==="selectMany"&&m.length===0,children:i(c.ok)},"confirm")],children:D(se,{count:X,first:w,max:N,onNextClick:L,onPreviousClick:L,onPerPageSelect:(a,t)=>{L(a),I(t)},inputGroupName:"search",inputGroupOnEnter:a=>{K(a),R(a!==""),L(0),I(10),g([]),y(void 0)},inputGroupPlaceholder:i("searchForGroups"),children:[D(ie,{children:[n.length>0&&s(T,{children:s(A,{variant:"link",onClick:()=>{y(void 0),g([]),L(0),I(10)},children:i("groups")})},"home"),n.map((a,t)=>D(T,{children:[n.length-1!==t&&s(A,{variant:"link",onClick:()=>{y(a.id),g([...n].slice(0,t)),L(0),I(10)},children:a.name}),n.length-1===t&&a.name]},t))]}),s(ce,{"aria-label":i("groups"),isCompact:!0,children:x.slice(0,N).map(a=>D(le,{children:[(!b||a.name?.toLocaleUpperCase().includes(P.toLocaleUpperCase()))&&s(U,{group:a,isRowDisabled:O,onSelect:y,type:l,isSearching:b,setIsSearching:R,selectedRows:m,setSelectedRows:f,canBrowse:p},a.id),b&&a.subGroups?.map(t=>s(U,{group:t,isRowDisabled:O,onSelect:y,type:l,isSearching:b,setIsSearching:R,selectedRows:m,setSelectedRows:f,canBrowse:p},t.id))]},a.id))}),x.length===0&&!b&&s(V,{hasIcon:!1,message:i("moveGroupEmpty"),instructions:k?i("moveGroupEmptyInstructions"):void 0}),x.length===0&&b&&s(V,{message:i("noSearchResults"),instructions:i("noSearchResultsInstructions")})]})})},U=({group:e,type:l,isRowDisabled:o,isSearching:c,setIsSearching:p,onSelect:k,selectedRows:u,setSelectedRows:r,canBrowse:d})=>{const{t:i}=z();return s(oe,{"aria-labelledby":e.name,id:e.id,onClick:m=>{l==="selectOne"?k(e.id):m.target.type!=="checkbox"&&e.subGroupCount!==0&&(k(e.id),p(!1))},children:D(re,{className:`join-group-dialog-row${o(e)?"-m-disabled":""}`,"data-testid":e.name,children:[l==="selectMany"&&s(_,{className:"kc-join-group-modal-check","data-testid":`${e.name}-check`,"aria-label":e.name,checked:e.checked,isDisabled:o(e),onChange:(m,f)=>{e.checked=f;let n=[];e.checked?n=[...u,e]:n=u.filter(g=>g.id!==e.id),r(n)},"aria-labelledby":`select-${e.name}`}),s(de,{dataListCells:[s(me,{className:"keycloak-groups-group-path",children:c?s(he,{id:`select-${e.name}`,group:e}):s("span",{id:`select-${e.name}`,children:e.name})},`name-${e.id}`)]}),s(J,{id:"actions","aria-labelledby":`select-${e.name}`,"aria-label":i("groupName"),isPlainButtonAction:!0,children:(d||l==="selectOne")&&e.subGroupCount!==0&&s(A,{variant:"link","aria-label":i("select"),children:s(ne,{})})})]})},e.id)};export{fe as G,he as a};
//# sourceMappingURL=GroupPickerDialog-CRtxj-P-.js.map
