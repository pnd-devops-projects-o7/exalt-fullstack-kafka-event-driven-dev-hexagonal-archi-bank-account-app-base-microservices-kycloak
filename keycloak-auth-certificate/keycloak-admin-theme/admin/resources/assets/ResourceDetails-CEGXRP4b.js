import{jsx as e,jsxs as I,Fragment as R}from"react/jsx-runtime";import{u as T,a as H,Y as O,C as L,x as V,J as S,K as w,N as E,c6 as K,c7 as j,ai as q,$ as G,j as U,b as $,b_ as Q,bs as J,p as P,cE as F,D as W,P as Y,m as X,Q as g,A as Z,f as N,B as ee,L as ae,o as re,cp as se,n as te}from"./main-C047jAp3.js";import{useState as m}from"react";import{D as oe}from"./SwitchControl-87mhceN2.js";import{u as ne}from"./ConfirmDialog-d09hGFUk.js";import{F as ie}from"./FormAccess-CEFqBG2E.js";import{K as le}from"./KeyValueInput-B35agFBw.js";import{M as ce}from"./MultiLineInput-lQlb7SN3.js";import{V as ue}from"./ViewHeader-Y2Z8ln-o.js";import{u as de}from"./useParams-6mfeCu18.js";import"react-dom";import"./copy-icon-D1BxihC2.js";import"./KeySelect-DvFB2tXI.js";import"./useToggle-K3Kx99tM.js";const me=({clientId:i})=>{const{adminClient:a}=T(),{t:l}=H(),{control:y}=O(),[A,v]=m(!1),[u,C]=m(),[p,h]=m("");L(()=>{const n={id:i,first:0,max:20,deep:!1,name:p};return a.clients.listAllScopes(n)},C,[p]);const b=n=>n.map(r=>e(q,{value:r,children:r.name},r.id));return u?e(S,{label:l("authorizationScopes"),labelIcon:e(w,{helpText:l("clientScopesHelp"),fieldLabelId:"scopes"}),fieldId:"scopes",children:e(E,{name:"scopes",defaultValue:[],control:y,render:({field:n})=>e(K,{toggleId:"scopes",variant:j.typeaheadMulti,chipGroupProps:{numChips:3,expandedText:l("hide"),collapsedText:l("showRemaining")},onToggle:r=>v(r),isOpen:A,selections:n.value.map(r=>r.name),onFilter:r=>(h(r),b(u)),onSelect:r=>{const s=typeof r=="string"?r:r.name,t=n.value.find(c=>c.name===s)?n.value.filter(c=>c.name!==s):[...n.value,r];n.onChange(t)},onClear:()=>{h(""),n.onChange([])},typeAheadAriaLabel:l("authorizationScopes"),children:b(u)})})}):e(V,{})};function Re(){const{adminClient:i}=T(),{t:a}=H(),[l,y]=m(),[A,v]=m(),[u,C]=m(),{addAlert:p,addError:h}=G(),b=U({mode:"onChange"}),{setValue:n,handleSubmit:r}=b,{id:s,resourceId:t,realm:c}=de(),x=$(),_=(o={})=>{te(o,n)},{hasAccess:k}=Q(),D=!k("manage-authorization");L(()=>Promise.all([i.clients.findOne({id:s}),t?i.clients.getResource({id:s,resourceId:t}):Promise.resolve(void 0),t?i.clients.listPermissionsByResource({id:s,resourceId:t}):Promise.resolve(void 0)]),([o,d,f])=>{if(!o)throw new Error(a("notFound"));y(o),C(f),v(d),_(d)},[]);const z=async o=>{const d=re(o);try{if(t)await i.clients.updateResource({id:s,resourceId:t},d);else{const f=await i.clients.createResource({id:s},d);v(d),x(se({realm:c,id:s,resourceId:f._id}))}p(a((t?"update":"create")+"ResourceSuccess"),P.success)}catch(f){h("resourceSaveError",f)}},[B,M]=ne({titleKey:"deleteResource",children:I(R,{children:[a("deleteResourceConfirm"),u?.length!==0&&e(J,{variant:"warning",isInline:!0,isPlain:!0,title:a("deleteResourceWarning"),className:"pf-v5-u-pt-lg",children:e("p",{className:"pf-v5-u-pt-xs",children:u?.map(o=>e("strong",{className:"pf-v5-u-pr-md",children:o.name},o.id))})})]}),continueButtonLabel:"confirm",onConfirm:async()=>{try{await i.clients.delResource({id:s,resourceId:t}),p(a("resourceDeletedSuccess"),P.success),x(F({realm:c,clientId:s,tab:"resources"}))}catch(o){h("resourceDeletedError",o)}}});return l?I(R,{children:[e(M,{}),e(ue,{titleKey:t?A?.name:"createResource",dropdownItems:t?[e(W,{"data-testid":"delete-resource",isDisabled:D,onClick:()=>B(),children:a("delete")},"delete")]:void 0}),e(Y,{variant:"light",children:e(X,{...b,children:I(ie,{isHorizontal:!0,role:"manage-authorization",className:"keycloak__resource-details__form",onSubmit:r(z),children:[e(g,{name:t?"owner.name":"",label:a("owner"),labelIcon:a("ownerHelp"),defaultValue:l.clientId,readOnly:!0}),e(g,{name:"name",label:a("name"),labelIcon:a("resourceNameHelp"),rules:{required:a("required")}}),e(g,{name:"displayName",label:a("displayName"),labelIcon:a("displayNameHelp"),rules:{required:a("required")}}),e(g,{name:"type",label:a("type"),labelIcon:a("resourceDetailsTypeHelp")}),e(S,{label:a("uris"),fieldId:"uris",labelIcon:e(w,{helpText:a("urisHelp"),fieldLabelId:"uris"}),children:e(ce,{name:"uris",type:"url","aria-label":a("uris"),addButtonLabel:"addUri"})}),e(me,{clientId:s}),e(g,{name:"icon_uri",label:a("iconUri"),labelIcon:a("iconUriHelp"),type:"url"}),e(oe,{name:"ownerManagedAccess",label:a("ownerManagedAccess"),labelIcon:a("ownerManagedAccessHelp")}),e(S,{hasNoPaddingTop:!0,label:a("resourceAttribute"),labelIcon:e(w,{helpText:a("resourceAttributeHelp"),fieldLabelId:"resourceAttribute"}),fieldId:"resourceAttribute",children:e(le,{name:"attributes",isDisabled:D})}),e(Z,{children:I("div",{className:"pf-v5-u-mt-md",children:[e(N,{variant:ee.primary,type:"submit","data-testid":"save",children:a("save")}),e(N,{variant:"link","data-testid":"cancel",component:o=>e(ae,{...o,to:F({realm:c,clientId:s,tab:"resources"})}),children:a("cancel")})]})})]})})})]}):e(V,{})}export{Re as default};
//# sourceMappingURL=ResourceDetails-CEGXRP4b.js.map
