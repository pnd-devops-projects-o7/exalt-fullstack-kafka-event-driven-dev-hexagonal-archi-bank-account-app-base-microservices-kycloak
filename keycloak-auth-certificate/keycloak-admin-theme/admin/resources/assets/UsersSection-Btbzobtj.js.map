{"version":3,"file":"UsersSection-Btbzobtj.js","sources":["../../../../../../../src/user/details/SearchFilter.tsx","../../../../../../../src/components/users/UserDataTableAttributeSearchForm.tsx","../../../../../../../src/components/users/UserDataTableToolbarItems.tsx","../../../../../../../src/components/users/UserDataTable.tsx","../../../../../../../src/user/UsersSection.tsx"],"sourcesContent":["import { KeycloakSelect } from \"@keycloak/keycloak-ui-shared\";\nimport {\n  Dropdown,\n  DropdownItem,\n  DropdownList,\n  MenuToggle,\n  SelectOption,\n  ToolbarItem,\n} from \"@patternfly/react-core\";\nimport { FilterIcon } from \"@patternfly/react-icons\";\nimport { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\nexport type SearchType = \"default\" | \"attribute\";\n\ntype SearchToolbarProps = SearchDropdownProps;\n\ntype SearchDropdownProps = {\n  searchType: SearchType;\n  onSelect: (value: SearchType) => void;\n};\n\nexport const SearchDropdown = ({\n  searchType,\n  onSelect,\n}: SearchDropdownProps) => {\n  const { t } = useTranslation();\n  const [searchToggle, setSearchToggle] = useState(false);\n\n  const createDropdown = (searchType: SearchType) => (\n    <DropdownItem\n      key={searchType}\n      onClick={() => {\n        onSelect(searchType);\n        setSearchToggle(false);\n      }}\n    >\n      {t(`searchType.${searchType}`)}\n    </DropdownItem>\n  );\n  const options = [createDropdown(\"default\"), createDropdown(\"attribute\")];\n\n  return (\n    <Dropdown\n      className=\"keycloak__users__searchtype\"\n      onOpenChange={(isOpen) => setSearchToggle(isOpen)}\n      toggle={(ref) => (\n        <MenuToggle\n          data-testid=\"user-search-toggle\"\n          ref={ref}\n          id=\"toggle-id\"\n          onClick={() => setSearchToggle(!searchToggle)}\n          icon={<FilterIcon />}\n        >\n          {t(`searchType.${searchType}`)}\n        </MenuToggle>\n      )}\n      isOpen={searchToggle}\n    >\n      <DropdownList>{options}</DropdownList>\n    </Dropdown>\n  );\n};\n\nexport const SearchToolbar = ({ searchType, onSelect }: SearchToolbarProps) => {\n  const { t } = useTranslation();\n  const [open, setOpen] = useState(false);\n\n  return (\n    <>\n      <ToolbarItem>\n        <SearchDropdown searchType={searchType} onSelect={onSelect} />\n      </ToolbarItem>\n      <ToolbarItem>\n        <KeycloakSelect\n          className=\"keycloak__users__searchtype\"\n          onToggle={(val) => setOpen(val)}\n          isOpen={open}\n          selections={[t(\"default\"), t(\"attribute\")]}\n          onSelect={() => setOpen(false)}\n        >\n          <SelectOption value={\"default\"}>{t(\"default\")}</SelectOption>\n          <SelectOption value={\"attribute\"}>{t(\"attribute\")}</SelectOption>\n        </KeycloakSelect>\n      </ToolbarItem>\n    </>\n  );\n};\n","import type { UserProfileConfig } from \"@keycloak/keycloak-admin-client/lib/defs/userProfileMetadata\";\nimport {\n  KeycloakSelect,\n  SelectVariant,\n  label,\n  useAlerts,\n} from \"@keycloak/keycloak-ui-shared\";\nimport {\n  ActionGroup,\n  Alert,\n  AlertVariant,\n  Button,\n  ButtonVariant,\n  Checkbox,\n  InputGroup,\n  InputGroupItem,\n  SelectOption,\n  Text,\n  TextContent,\n  TextInput,\n  TextVariants,\n} from \"@patternfly/react-core\";\nimport { CheckIcon } from \"@patternfly/react-icons\";\nimport { ReactNode, useState } from \"react\";\nimport { Controller, useForm } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\nimport { Form } from \"react-router-dom\";\nimport { UserAttribute, UserFilter } from \"./UserDataTable\";\n\ntype UserDataTableAttributeSearchFormProps = {\n  activeFilters: UserFilter;\n  setActiveFilters: (filters: UserFilter) => void;\n  profile: UserProfileConfig;\n  createAttributeSearchChips: () => ReactNode;\n  searchUserWithAttributes: () => void;\n};\n\ntype UserFilterForm = UserAttribute & { exact: boolean };\n\nexport function UserDataTableAttributeSearchForm({\n  activeFilters,\n  setActiveFilters,\n  profile,\n  createAttributeSearchChips,\n  searchUserWithAttributes,\n}: UserDataTableAttributeSearchFormProps) {\n  const { t } = useTranslation();\n  const { addAlert } = useAlerts();\n  const [selectAttributeKeyOpen, setSelectAttributeKeyOpen] = useState(false);\n\n  const defaultValues: UserAttribute = {\n    name: \"\",\n    displayName: \"\",\n    value: \"\",\n  };\n\n  const {\n    getValues,\n    register,\n    reset,\n    formState: { errors },\n    setValue,\n    setError,\n    clearErrors,\n    control,\n  } = useForm<UserFilterForm>({\n    mode: \"onChange\",\n    defaultValues,\n  });\n\n  const isAttributeKeyDuplicate = () => {\n    return activeFilters.userAttribute.some(\n      (filter) => filter.name === getValues().name,\n    );\n  };\n\n  const isAttributeNameValid = () => {\n    let valid = false;\n    if (!getValues().name.length) {\n      setError(\"name\", {\n        type: \"empty\",\n        message: t(\"searchUserByAttributeMissingKeyError\"),\n      });\n    } else if (\n      activeFilters.userAttribute.some(\n        (filter) => filter.name === getValues().name,\n      )\n    ) {\n      setError(\"name\", {\n        type: \"conflict\",\n        message: t(\"searchUserByAttributeKeyAlreadyInUseError\"),\n      });\n    } else {\n      valid = true;\n    }\n    return valid;\n  };\n\n  const isAttributeValueValid = () => {\n    let valid = false;\n    if (!getValues().value.length) {\n      setError(\"value\", {\n        type: \"empty\",\n        message: t(\"searchUserByAttributeMissingValueError\"),\n      });\n    } else {\n      valid = true;\n    }\n    return valid;\n  };\n\n  const isAttributeValid = () =>\n    isAttributeNameValid() && isAttributeValueValid();\n\n  const addToFilter = () => {\n    if (isAttributeValid()) {\n      setActiveFilters({\n        exact: getValues().exact,\n        userAttribute: [...activeFilters.userAttribute, { ...getValues() }],\n      });\n      reset({ exact: getValues().exact });\n    } else {\n      if (errors.name?.message) {\n        addAlert(errors.name.message, AlertVariant.danger);\n      }\n\n      if (errors.value?.message) {\n        addAlert(errors.value.message, AlertVariant.danger);\n      }\n    }\n  };\n\n  const clearActiveFilters = () => {\n    const filtered = [...activeFilters.userAttribute].filter(\n      (chip) => chip.name !== chip.name,\n    );\n    setActiveFilters({ exact: getValues().exact, userAttribute: filtered });\n  };\n\n  const createAttributeKeyInputField = () => {\n    if (profile) {\n      return (\n        <KeycloakSelect\n          data-testid=\"search-attribute-name-select\"\n          variant={SelectVariant.typeahead}\n          onToggle={(isOpen) => setSelectAttributeKeyOpen(isOpen)}\n          selections={getValues().displayName}\n          onSelect={(selectedValue) => {\n            setValue(\"displayName\", selectedValue.toString());\n            if (isAttributeKeyDuplicate()) {\n              setError(\"name\", { type: \"conflict\" });\n            } else {\n              clearErrors(\"name\");\n            }\n          }}\n          isOpen={selectAttributeKeyOpen}\n          placeholderText={t(\"selectAttribute\")}\n          validated={errors.name && \"error\"}\n          maxHeight={300}\n          {...register(\"displayName\", {\n            required: true,\n            validate: isAttributeNameValid,\n          })}\n        >\n          {profile.attributes?.map((option) => (\n            <SelectOption\n              key={option.name}\n              value={label(t, option.displayName!, option.name)}\n              onClick={(e) => {\n                e.stopPropagation();\n                setSelectAttributeKeyOpen(false);\n                setValue(\"name\", option.name!);\n              }}\n            >\n              {label(t, option.displayName!, option.name)}\n            </SelectOption>\n          ))}\n        </KeycloakSelect>\n      );\n    } else {\n      return (\n        <TextInput\n          id=\"name\"\n          placeholder={t(\"keyPlaceholder\")}\n          validated={errors.name && \"error\"}\n          onKeyDown={(e) => e.key === \"Enter\" && addToFilter()}\n          {...register(\"name\", {\n            required: true,\n            validate: isAttributeNameValid,\n          })}\n        />\n      );\n    }\n  };\n\n  return (\n    <Form\n      className=\"user-attribute-search-form\"\n      data-testid=\"user-attribute-search-form\"\n    >\n      <TextContent className=\"user-attribute-search-form-headline\">\n        <Text component={TextVariants.h2}>{t(\"selectAttributes\")}</Text>\n      </TextContent>\n      <Alert\n        isInline\n        className=\"user-attribute-search-form-alert\"\n        variant=\"info\"\n        title={t(\"searchUserByAttributeDescription\")}\n        component=\"h3\"\n      />\n      <TextContent className=\"user-attribute-search-form-key-value\">\n        <div className=\"user-attribute-search-form-left\">\n          <Text component={TextVariants.h3}>{t(\"key\")}</Text>\n        </div>\n        <div className=\"user-attribute-search-form-right\">\n          <Text component={TextVariants.h3}>{t(\"value\")}</Text>\n        </div>\n      </TextContent>\n      <div className=\"user-attribute-search-form-left\">\n        {createAttributeKeyInputField()}\n      </div>\n      <div className=\"user-attribute-search-form-right\">\n        <InputGroup>\n          <InputGroupItem>\n            <TextInput\n              id=\"value\"\n              placeholder={t(\"valuePlaceholder\")}\n              validated={errors.value && \"error\"}\n              onKeyDown={(e) => {\n                if (e.key === \"Enter\") {\n                  e.preventDefault();\n                  addToFilter();\n                }\n              }}\n              {...register(\"value\", {\n                required: true,\n                validate: isAttributeValueValid,\n              })}\n            />\n          </InputGroupItem>\n          <InputGroupItem>\n            <Button\n              data-testid=\"user-attribute-search-add-filter-button\"\n              variant=\"control\"\n              icon={<CheckIcon />}\n              onClick={addToFilter}\n              aria-label={t(\"addToFilter\")}\n            />\n          </InputGroupItem>\n        </InputGroup>\n      </div>\n      {createAttributeSearchChips()}\n\n      <div className=\"pf-v5-u-pt-lg\">\n        <Controller\n          name=\"exact\"\n          defaultValue={false}\n          control={control}\n          render={({ field }) => (\n            <Checkbox\n              id=\"exact\"\n              data-testid=\"exact\"\n              label={t(\"exactSearch\")}\n              isChecked={field.value}\n              onChange={field.onChange}\n            />\n          )}\n        />\n      </div>\n      <ActionGroup className=\"user-attribute-search-form-action-group\">\n        <Button\n          data-testid=\"search-user-attribute-btn\"\n          variant=\"primary\"\n          type=\"submit\"\n          isDisabled={!activeFilters.userAttribute.length}\n          onClick={searchUserWithAttributes}\n        >\n          {t(\"search\")}\n        </Button>\n        <Button\n          variant={ButtonVariant.link}\n          onClick={() => {\n            reset();\n            clearActiveFilters();\n          }}\n        >\n          {t(\"reset\")}\n        </Button>\n      </ActionGroup>\n    </Form>\n  );\n}\n","import type RealmRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/realmRepresentation\";\nimport type { UserProfileConfig } from \"@keycloak/keycloak-admin-client/lib/defs/userProfileMetadata\";\nimport {\n  Button,\n  ButtonVariant,\n  Dropdown,\n  DropdownItem,\n  DropdownList,\n  InputGroup,\n  InputGroupItem,\n  MenuToggle,\n  SearchInput,\n  ToolbarItem,\n} from \"@patternfly/react-core\";\nimport { ArrowRightIcon, EllipsisVIcon } from \"@patternfly/react-icons\";\nimport { ReactNode, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { useAccess } from \"../../context/access/Access\";\nimport { SearchDropdown, SearchType } from \"../../user/details/SearchFilter\";\nimport DropdownPanel from \"../dropdown-panel/DropdownPanel\";\nimport { UserFilter } from \"./UserDataTable\";\nimport { UserDataTableAttributeSearchForm } from \"./UserDataTableAttributeSearchForm\";\n\ntype UserDataTableToolbarItemsProps = {\n  searchDropdownOpen: boolean;\n  setSearchDropdownOpen: (open: boolean) => void;\n  realm: RealmRepresentation;\n  hasSelectedRows: boolean;\n  toggleDeleteDialog: () => void;\n  toggleUnlockUsersDialog: () => void;\n  goToCreate: () => void;\n  searchType: SearchType;\n  setSearchType: (searchType: SearchType) => void;\n  searchUser: string;\n  setSearchUser: (searchUser: string) => void;\n  activeFilters: UserFilter;\n  setActiveFilters: (activeFilters: UserFilter) => void;\n  refresh: () => void;\n  profile: UserProfileConfig;\n  clearAllFilters: () => void;\n  createAttributeSearchChips: () => ReactNode;\n  searchUserWithAttributes: () => void;\n};\n\nexport function UserDataTableToolbarItems({\n  searchDropdownOpen,\n  setSearchDropdownOpen,\n  realm,\n  hasSelectedRows,\n  toggleDeleteDialog,\n  toggleUnlockUsersDialog,\n  goToCreate,\n  searchType,\n  setSearchType,\n  searchUser,\n  setSearchUser,\n  activeFilters,\n  setActiveFilters,\n  refresh,\n  profile,\n  clearAllFilters,\n  createAttributeSearchChips,\n  searchUserWithAttributes,\n}: UserDataTableToolbarItemsProps) {\n  const { t } = useTranslation();\n  const [kebabOpen, setKebabOpen] = useState(false);\n\n  const { hasAccess } = useAccess();\n\n  // Only needs query-users access to attempt add/delete of users.\n  // This is because the user could have fine-grained access to users\n  // of a group.  There is no way to know this without searching the\n  // permissions of every group.\n  const isManager = hasAccess(\"query-users\");\n\n  const searchItem = () => {\n    return (\n      <ToolbarItem>\n        <InputGroup>\n          <InputGroupItem>\n            <SearchDropdown\n              searchType={searchType}\n              onSelect={(searchType) => {\n                clearAllFilters();\n                setSearchType(searchType);\n              }}\n            />\n          </InputGroupItem>\n          {searchType === \"default\" && defaultSearchInput()}\n          {searchType === \"attribute\" && attributeSearchInput()}\n        </InputGroup>\n      </ToolbarItem>\n    );\n  };\n\n  const defaultSearchInput = () => {\n    return (\n      <ToolbarItem>\n        <SearchInput\n          data-testid=\"table-search-input\"\n          placeholder={t(\"searchForUser\")}\n          aria-label={t(\"search\")}\n          value={searchUser}\n          onSearch={(_, _v, attribute) => {\n            setSearchUser(attribute[\"haswords\"]);\n            refresh();\n          }}\n          onKeyDown={(e) => {\n            if (e.key === \"Enter\") {\n              const target = e.target as HTMLInputElement;\n              setSearchUser(target.value);\n              refresh();\n            }\n          }}\n          onClear={() => {\n            setSearchUser(\"\");\n            refresh();\n          }}\n        />\n      </ToolbarItem>\n    );\n  };\n\n  const attributeSearchInput = () => {\n    return (\n      <>\n        <DropdownPanel\n          data-testid=\"select-attributes-dropdown\"\n          buttonText={t(\"selectAttributes\")}\n          setSearchDropdownOpen={setSearchDropdownOpen}\n          searchDropdownOpen={searchDropdownOpen}\n          width=\"15vw\"\n        >\n          <UserDataTableAttributeSearchForm\n            activeFilters={activeFilters}\n            setActiveFilters={setActiveFilters}\n            profile={profile}\n            createAttributeSearchChips={createAttributeSearchChips}\n            searchUserWithAttributes={() => {\n              searchUserWithAttributes();\n              setSearchDropdownOpen(false);\n            }}\n          />\n        </DropdownPanel>\n        <Button\n          icon={<ArrowRightIcon />}\n          variant=\"control\"\n          onClick={() => {\n            searchUserWithAttributes();\n            setSearchDropdownOpen(false);\n          }}\n          aria-label={t(\"searchAttributes\")}\n        />\n      </>\n    );\n  };\n\n  const bruteForceProtectionToolbarItem = !realm.bruteForceProtected ? (\n    <ToolbarItem>\n      <Button\n        variant={ButtonVariant.link}\n        onClick={toggleDeleteDialog}\n        data-testid=\"delete-user-btn\"\n        isDisabled={hasSelectedRows}\n      >\n        {t(\"deleteUser\")}\n      </Button>\n    </ToolbarItem>\n  ) : (\n    <ToolbarItem>\n      <Dropdown\n        onOpenChange={(isOpen) => setKebabOpen(isOpen)}\n        toggle={(ref) => (\n          <MenuToggle\n            ref={ref}\n            isExpanded={kebabOpen}\n            variant=\"plain\"\n            onClick={() => setKebabOpen(!kebabOpen)}\n          >\n            <EllipsisVIcon />\n          </MenuToggle>\n        )}\n        isOpen={kebabOpen}\n        shouldFocusToggleOnSelect\n      >\n        <DropdownList>\n          <DropdownItem\n            key=\"deleteUser\"\n            component=\"button\"\n            isDisabled={hasSelectedRows}\n            onClick={() => {\n              toggleDeleteDialog();\n              setKebabOpen(false);\n            }}\n          >\n            {t(\"deleteUser\")}\n          </DropdownItem>\n\n          <DropdownItem\n            key=\"unlock\"\n            component=\"button\"\n            onClick={() => {\n              toggleUnlockUsersDialog();\n              setKebabOpen(false);\n            }}\n          >\n            {t(\"unlockAllUsers\")}\n          </DropdownItem>\n        </DropdownList>\n      </Dropdown>\n    </ToolbarItem>\n  );\n\n  const actionItems = (\n    <>\n      <ToolbarItem>\n        <Button data-testid=\"add-user\" onClick={goToCreate}>\n          {t(\"addUser\")}\n        </Button>\n      </ToolbarItem>\n      {bruteForceProtectionToolbarItem}\n    </>\n  );\n\n  return (\n    <>\n      {searchItem()}\n      {isManager ? actionItems : null}\n    </>\n  );\n}\n","import type { UserProfileConfig } from \"@keycloak/keycloak-admin-client/lib/defs/userProfileMetadata\";\nimport type UserRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/userRepresentation\";\nimport {\n  KeycloakDataTable,\n  KeycloakSpinner,\n  ListEmptyState,\n  useAlerts,\n  useFetch,\n} from \"@keycloak/keycloak-ui-shared\";\nimport {\n  AlertVariant,\n  Button,\n  ButtonVariant,\n  Chip,\n  ChipGroup,\n  EmptyState,\n  FlexItem,\n  Label,\n  Text,\n  TextContent,\n  Toolbar,\n  ToolbarContent,\n  ToolbarItem,\n  Tooltip,\n} from \"@patternfly/react-core\";\nimport {\n  ExclamationCircleIcon,\n  InfoCircleIcon,\n  WarningTriangleIcon,\n} from \"@patternfly/react-icons\";\nimport type { IRowData } from \"@patternfly/react-table\";\nimport { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { useAdminClient } from \"../../admin-client\";\nimport { fetchRealmInfo } from \"../../context/auth/admin-ui-endpoint\";\nimport { UiRealmInfo } from \"../../context/auth/uiRealmInfo\";\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\nimport { SearchType } from \"../../user/details/SearchFilter\";\nimport { toAddUser } from \"../../user/routes/AddUser\";\nimport { toUser } from \"../../user/routes/User\";\nimport { emptyFormatter } from \"../../util\";\nimport { useConfirmDialog } from \"../confirm-dialog/ConfirmDialog\";\nimport { BruteUser, findUsers } from \"../role-mapping/resource\";\nimport { UserDataTableToolbarItems } from \"./UserDataTableToolbarItems\";\n\nexport type UserFilter = {\n  exact: boolean;\n  userAttribute: UserAttribute[];\n};\n\nexport type UserAttribute = {\n  name: string;\n  displayName: string;\n  value: string;\n};\n\nconst UserDetailLink = (user: BruteUser) => {\n  const { t } = useTranslation();\n  const { realm } = useRealm();\n  return (\n    <>\n      <Link to={toUser({ realm, id: user.id!, tab: \"settings\" })}>\n        {user.username}\n        <StatusRow user={user} />\n      </Link>\n      {user.attributes?.[\"is_temporary_admin\"][0] === \"true\" && (\n        <Tooltip content={t(\"temporaryAdmin\")}>\n          <WarningTriangleIcon\n            className=\"pf-v5-u-ml-sm\"\n            id=\"temporary-admin-label\"\n          />\n        </Tooltip>\n      )}\n    </>\n  );\n};\n\ntype StatusRowProps = {\n  user: BruteUser;\n};\n\nconst StatusRow = ({ user }: StatusRowProps) => {\n  const { t } = useTranslation();\n  return (\n    <>\n      {!user.enabled && (\n        <Label color=\"red\" icon={<InfoCircleIcon />}>\n          {t(\"disabled\")}\n        </Label>\n      )}\n      {user.bruteForceStatus?.disabled && (\n        <Label color=\"orange\" icon={<WarningTriangleIcon />}>\n          {t(\"temporaryLocked\")}\n        </Label>\n      )}\n    </>\n  );\n};\n\nconst ValidatedEmail = (user: UserRepresentation) => {\n  const { t } = useTranslation();\n  return (\n    <>\n      {!user.emailVerified && (\n        <Tooltip content={t(\"notVerified\")}>\n          <ExclamationCircleIcon className=\"keycloak__user-section__email-verified\" />\n        </Tooltip>\n      )}{\" \"}\n      {emptyFormatter()(user.email)}\n    </>\n  );\n};\n\nexport function UserDataTable() {\n  const { adminClient } = useAdminClient();\n\n  const { t } = useTranslation();\n  const { addAlert, addError } = useAlerts();\n  const { realm: realmName, realmRepresentation: realm } = useRealm();\n  const navigate = useNavigate();\n  const [uiRealmInfo, setUiRealmInfo] = useState<UiRealmInfo>({});\n  const [searchUser, setSearchUser] = useState(\"\");\n  const [selectedRows, setSelectedRows] = useState<UserRepresentation[]>([]);\n  const [searchType, setSearchType] = useState<SearchType>(\"default\");\n  const [searchDropdownOpen, setSearchDropdownOpen] = useState(false);\n  const [activeFilters, setActiveFilters] = useState<UserFilter>({\n    exact: false,\n    userAttribute: [],\n  });\n  const [profile, setProfile] = useState<UserProfileConfig>({});\n  const [query, setQuery] = useState(\"\");\n\n  const [key, setKey] = useState(0);\n  const refresh = () => setKey(key + 1);\n\n  useFetch(\n    async () => {\n      try {\n        return await Promise.all([\n          fetchRealmInfo(adminClient),\n          adminClient.users.getProfile(),\n        ]);\n      } catch {\n        return [{}, {}] as [UiRealmInfo, UserProfileConfig];\n      }\n    },\n    ([uiRealmInfo, profile]) => {\n      setUiRealmInfo(uiRealmInfo);\n      setProfile(profile);\n    },\n    [],\n  );\n\n  const loader = async (first?: number, max?: number, search?: string) => {\n    const params: { [name: string]: string | number | boolean } = {\n      first: first!,\n      max: max!,\n      q: query!,\n      exact: activeFilters.exact,\n    };\n\n    const searchParam = search || searchUser || \"\";\n    if (searchParam) {\n      params.search = searchParam;\n    }\n\n    if (!listUsers && !(params.search || params.q)) {\n      return [];\n    }\n\n    try {\n      return await findUsers(adminClient, {\n        briefRepresentation: true,\n        ...params,\n      });\n    } catch (error) {\n      if (uiRealmInfo.userProfileProvidersEnabled) {\n        addError(\"noUsersFoundErrorStorage\", error);\n      } else {\n        addError(\"noUsersFoundError\", error);\n      }\n      return [];\n    }\n  };\n\n  const [toggleUnlockUsersDialog, UnlockUsersConfirm] = useConfirmDialog({\n    titleKey: \"unlockAllUsers\",\n    messageKey: \"unlockUsersConfirm\",\n    continueButtonLabel: \"unlock\",\n    onConfirm: async () => {\n      try {\n        await adminClient.attackDetection.delAll();\n        refresh();\n        addAlert(t(\"unlockUsersSuccess\"), AlertVariant.success);\n      } catch (error) {\n        addError(\"unlockUsersError\", error);\n      }\n    },\n  });\n\n  const [toggleDeleteDialog, DeleteConfirm] = useConfirmDialog({\n    titleKey: \"deleteConfirmUsers\",\n    messageKey: t(\"deleteConfirmDialog\", { count: selectedRows.length }),\n    continueButtonLabel: \"delete\",\n    continueButtonVariant: ButtonVariant.danger,\n    onConfirm: async () => {\n      try {\n        for (const user of selectedRows) {\n          await adminClient.users.del({ id: user.id! });\n        }\n        setSelectedRows([]);\n        clearAllFilters();\n        addAlert(t(\"userDeletedSuccess\"), AlertVariant.success);\n      } catch (error) {\n        addError(\"userDeletedError\", error);\n      }\n    },\n  });\n\n  const goToCreate = () => navigate(toAddUser({ realm: realmName }));\n\n  if (!uiRealmInfo || !realm) {\n    return <KeycloakSpinner />;\n  }\n\n  //should *only* list users when no user federation is configured\n  const listUsers = !uiRealmInfo.userProfileProvidersEnabled;\n\n  const clearAllFilters = () => {\n    setActiveFilters({ exact: false, userAttribute: [] });\n    setSearchUser(\"\");\n    setQuery(\"\");\n    refresh();\n  };\n\n  const createQueryString = (filters: UserFilter) => {\n    return filters.userAttribute\n      .map((filter) => `${filter.name}:${filter.value}`)\n      .join(\" \");\n  };\n\n  const searchUserWithAttributes = () => {\n    const attributes = createQueryString(activeFilters);\n    setQuery(attributes);\n    refresh();\n  };\n\n  const createAttributeSearchChips = () => {\n    return (\n      <FlexItem>\n        {activeFilters.userAttribute.length > 0 && (\n          <>\n            {Object.values(activeFilters.userAttribute).map((entry) => {\n              return (\n                <ChipGroup\n                  className=\"pf-v5-u-mt-md pf-v5-u-mr-md\"\n                  data-testid=\"user-attribute-search-chips-group\"\n                  key={entry.name}\n                  categoryName={\n                    entry.displayName.length ? entry.displayName : entry.name\n                  }\n                  isClosable\n                  onClick={(event) => {\n                    event.stopPropagation();\n\n                    const filtered = [...activeFilters.userAttribute].filter(\n                      (chip) => chip.name !== entry.name,\n                    );\n                    const active = {\n                      userAttribute: filtered,\n                      exact: activeFilters.exact,\n                    };\n\n                    setActiveFilters(active);\n                    setQuery(createQueryString(active));\n                    refresh();\n                  }}\n                >\n                  <Chip key={entry.name} isReadOnly>\n                    {entry.value}\n                  </Chip>\n                </ChipGroup>\n              );\n            })}\n          </>\n        )}\n      </FlexItem>\n    );\n  };\n\n  const toolbar = () => {\n    return (\n      <UserDataTableToolbarItems\n        searchDropdownOpen={searchDropdownOpen}\n        setSearchDropdownOpen={setSearchDropdownOpen}\n        realm={realm}\n        hasSelectedRows={selectedRows.length === 0}\n        toggleDeleteDialog={toggleDeleteDialog}\n        toggleUnlockUsersDialog={toggleUnlockUsersDialog}\n        goToCreate={goToCreate}\n        searchType={searchType}\n        setSearchType={setSearchType}\n        searchUser={searchUser}\n        setSearchUser={setSearchUser}\n        activeFilters={activeFilters}\n        setActiveFilters={setActiveFilters}\n        refresh={refresh}\n        profile={profile}\n        clearAllFilters={clearAllFilters}\n        createAttributeSearchChips={createAttributeSearchChips}\n        searchUserWithAttributes={searchUserWithAttributes}\n      />\n    );\n  };\n\n  const subtoolbar = () => {\n    if (!activeFilters.userAttribute.length) {\n      return;\n    }\n    return (\n      <div className=\"user-attribute-search-form-subtoolbar\">\n        <ToolbarItem>{createAttributeSearchChips()}</ToolbarItem>\n        <ToolbarItem>\n          <Button\n            variant=\"link\"\n            onClick={() => {\n              clearAllFilters();\n            }}\n          >\n            {t(\"clearAllFilters\")}\n          </Button>\n        </ToolbarItem>\n      </div>\n    );\n  };\n\n  return (\n    <>\n      <DeleteConfirm />\n      <UnlockUsersConfirm />\n      <KeycloakDataTable\n        isSearching={\n          searchUser !== \"\" || activeFilters.userAttribute.length !== 0\n        }\n        key={key}\n        loader={loader}\n        isPaginated\n        ariaLabelKey=\"titleUsers\"\n        canSelectAll\n        onSelect={(rows: UserRepresentation[]) => setSelectedRows([...rows])}\n        emptyState={\n          !listUsers ? (\n            <>\n              <Toolbar>\n                <ToolbarContent>{toolbar()}</ToolbarContent>\n              </Toolbar>\n              <EmptyState data-testid=\"empty-state\" variant=\"lg\">\n                <TextContent className=\"kc-search-users-text\">\n                  <Text>{t(\"searchForUserDescription\")}</Text>\n                </TextContent>\n              </EmptyState>\n            </>\n          ) : (\n            <ListEmptyState\n              message={t(\"noUsersFound\")}\n              instructions={t(\"emptyInstructions\")}\n              primaryActionText={t(\"createNewUser\")}\n              onPrimaryAction={goToCreate}\n            />\n          )\n        }\n        toolbarItem={toolbar()}\n        subToolbar={subtoolbar()}\n        actionResolver={(rowData: IRowData) => {\n          const user: UserRepresentation = rowData.data;\n          if (!user.access?.manage) return [];\n\n          return [\n            {\n              title: t(\"delete\"),\n              onClick: () => {\n                setSelectedRows([user]);\n                toggleDeleteDialog();\n              },\n            },\n          ];\n        }}\n        columns={[\n          {\n            name: \"username\",\n            displayKey: \"username\",\n            cellRenderer: UserDetailLink,\n          },\n          {\n            name: \"email\",\n            displayKey: \"email\",\n            cellRenderer: ValidatedEmail,\n          },\n          {\n            name: \"lastName\",\n            displayKey: \"lastName\",\n            cellFormatters: [emptyFormatter()],\n          },\n          {\n            name: \"firstName\",\n            displayKey: \"firstName\",\n            cellFormatters: [emptyFormatter()],\n          },\n        ]}\n      />\n    </>\n  );\n}\n","import { useTranslation } from \"react-i18next\";\nimport { PageSection, Tab, TabTitleText } from \"@patternfly/react-core\";\n\nimport { ViewHeader } from \"../components/view-header/ViewHeader\";\nimport { useRealm } from \"../context/realm-context/RealmContext\";\nimport helpUrls from \"../help-urls\";\nimport { PermissionsTab } from \"../components/permission-tab/PermissionTab\";\nimport { UserDataTable } from \"../components/users/UserDataTable\";\nimport { toUsers, UserTab } from \"./routes/Users\";\nimport {\n  RoutableTabs,\n  useRoutableTab,\n} from \"../components/routable-tabs/RoutableTabs\";\nimport useIsFeatureEnabled, { Feature } from \"../utils/useIsFeatureEnabled\";\nimport \"./user-section.css\";\nimport { useAccess } from \"../context/access/Access\";\n\nexport default function UsersSection() {\n  const { t } = useTranslation();\n  const { realm: realmName } = useRealm();\n  const { hasAccess } = useAccess();\n  const isFeatureEnabled = useIsFeatureEnabled();\n\n  const canViewPermissions =\n    isFeatureEnabled(Feature.AdminFineGrainedAuthz) &&\n    hasAccess(\"manage-authorization\", \"manage-users\", \"manage-clients\");\n\n  const useTab = (tab: UserTab) =>\n    useRoutableTab(\n      toUsers({\n        realm: realmName,\n        tab,\n      }),\n    );\n\n  const listTab = useTab(\"list\");\n  const permissionsTab = useTab(\"permissions\");\n\n  return (\n    <>\n      <ViewHeader\n        titleKey=\"titleUsers\"\n        subKey=\"usersExplain\"\n        helpUrl={helpUrls.usersUrl}\n        divider={false}\n      />\n      <PageSection\n        data-testid=\"users-page\"\n        variant=\"light\"\n        className=\"pf-v5-u-p-0\"\n      >\n        <RoutableTabs\n          data-testid=\"user-tabs\"\n          defaultLocation={toUsers({\n            realm: realmName,\n            tab: \"list\",\n          })}\n          isBox\n          mountOnEnter\n        >\n          <Tab\n            id=\"list\"\n            data-testid=\"listTab\"\n            title={<TabTitleText>{t(\"userList\")}</TabTitleText>}\n            {...listTab}\n          >\n            <UserDataTable />\n          </Tab>\n          {canViewPermissions && (\n            <Tab\n              id=\"permissions\"\n              data-testid=\"permissionsTab\"\n              title={<TabTitleText>{t(\"permissions\")}</TabTitleText>}\n              {...permissionsTab}\n            >\n              <PermissionsTab type=\"users\" />\n            </Tab>\n          )}\n        </RoutableTabs>\n      </PageSection>\n    </>\n  );\n}\n"],"names":["SearchDropdown","searchType","onSelect","t","useTranslation","searchToggle","setSearchToggle","useState","createDropdown","jsx","DropdownItem","options","Dropdown","isOpen","ref","MenuToggle","FilterIcon","DropdownList","UserDataTableAttributeSearchForm","activeFilters","setActiveFilters","profile","createAttributeSearchChips","searchUserWithAttributes","addAlert","useAlerts","selectAttributeKeyOpen","setSelectAttributeKeyOpen","defaultValues","getValues","register","reset","errors","setValue","setError","clearErrors","control","useForm","isAttributeKeyDuplicate","filter","isAttributeNameValid","valid","isAttributeValueValid","isAttributeValid","addToFilter","AlertVariant","clearActiveFilters","filtered","chip","createAttributeKeyInputField","KeycloakSelect","SelectVariant","selectedValue","option","SelectOption","label","e","TextInput","jsxs","Form","TextContent","Text","TextVariants","Alert","InputGroup","InputGroupItem","Button","CheckIcon","Controller","field","Checkbox","ActionGroup","ButtonVariant","UserDataTableToolbarItems","searchDropdownOpen","setSearchDropdownOpen","realm","hasSelectedRows","toggleDeleteDialog","toggleUnlockUsersDialog","goToCreate","setSearchType","searchUser","setSearchUser","refresh","clearAllFilters","kebabOpen","setKebabOpen","hasAccess","useAccess","isManager","searchItem","ToolbarItem","defaultSearchInput","attributeSearchInput","SearchInput","_","_v","attribute","target","Fragment","DropdownPanel","ArrowRightIcon","bruteForceProtectionToolbarItem","EllipsisVIcon","actionItems","UserDetailLink","user","useRealm","Link","toUser","StatusRow","Tooltip","WarningTriangleIcon","Label","InfoCircleIcon","ValidatedEmail","ExclamationCircleIcon","emptyFormatter","UserDataTable","adminClient","useAdminClient","addError","realmName","navigate","useNavigate","uiRealmInfo","setUiRealmInfo","selectedRows","setSelectedRows","setProfile","query","setQuery","key","setKey","useFetch","fetchRealmInfo","loader","first","max","search","params","searchParam","listUsers","findUsers","error","UnlockUsersConfirm","useConfirmDialog","DeleteConfirm","toAddUser","KeycloakSpinner","createQueryString","filters","attributes","FlexItem","entry","ChipGroup","event","active","Chip","toolbar","subtoolbar","KeycloakDataTable","rows","ListEmptyState","Toolbar","ToolbarContent","EmptyState","rowData","UsersSection","canViewPermissions","useIsFeatureEnabled","Feature","useTab","tab","useRoutableTab","toUsers","listTab","permissionsTab","ViewHeader","helpUrls","PageSection","RoutableTabs","Tab","TabTitleText","PermissionsTab"],"mappings":"ipDAsBO,MAAMA,GAAiB,CAAC,CAC7B,WAAAC,EACA,SAAAC,CACF,IAA2B,CACnB,KAAA,CAAE,EAAAC,GAAMC,IACR,CAACC,EAAcC,CAAe,EAAIC,EAAS,EAAK,EAEhDC,EAAkBP,GACtBQ,EAACC,EAAA,CAEC,QAAS,IAAM,CACbR,EAASD,CAAU,EACnBK,EAAgB,EAAK,CACvB,EAEC,SAAAH,EAAE,cAAcF,CAAU,EAAE,CAAA,EANxBA,CAAA,EASHU,EAAU,CAACH,EAAe,SAAS,EAAGA,EAAe,WAAW,CAAC,EAGrE,OAAAC,EAACG,GAAA,CACC,UAAU,8BACV,aAAeC,GAAWP,EAAgBO,CAAM,EAChD,OAASC,GACPL,EAACM,GAAA,CACC,cAAY,qBACZ,IAAAD,EACA,GAAG,YACH,QAAS,IAAMR,EAAgB,CAACD,CAAY,EAC5C,OAAOW,GAAW,EAAA,EAEjB,SAAAb,EAAE,cAAcF,CAAU,EAAE,CAAA,CAC/B,EAEF,OAAQI,EAER,SAAAI,EAACQ,IAAc,SAAQN,CAAA,CAAA,CAAA,CAAA,CAG7B,ECvBO,SAASO,GAAiC,CAC/C,cAAAC,EACA,iBAAAC,EACA,QAAAC,EACA,2BAAAC,EACA,yBAAAC,CACF,EAA0C,CAClC,KAAA,CAAE,EAAApB,GAAMC,IACR,CAAE,SAAAoB,GAAaC,KACf,CAACC,EAAwBC,CAAyB,EAAIpB,EAAS,EAAK,EAEpEqB,EAA+B,CACnC,KAAM,GACN,YAAa,GACb,MAAO,EAAA,EAGH,CACJ,UAAAC,EACA,SAAAC,EACA,MAAAC,EACA,UAAW,CAAE,OAAAC,CAAO,EACpB,SAAAC,EACA,SAAAC,EACA,YAAAC,EACA,QAAAC,GACEC,GAAwB,CAC1B,KAAM,WACN,cAAAT,CAAA,CACD,EAEKU,EAA0B,IACvBnB,EAAc,cAAc,KAChCoB,GAAWA,EAAO,OAASV,EAAY,EAAA,IAAA,EAItCW,EAAuB,IAAM,CACjC,IAAIC,EAAQ,GACZ,OAAKZ,EAAA,EAAY,KAAK,OAMpBV,EAAc,cAAc,KACzBoB,GAAWA,EAAO,OAASV,EAAY,EAAA,IAAA,EAG1CK,EAAS,OAAQ,CACf,KAAM,WACN,QAAS/B,EAAE,2CAA2C,CAAA,CACvD,EAEOsC,EAAA,GAdRP,EAAS,OAAQ,CACf,KAAM,QACN,QAAS/B,EAAE,sCAAsC,CAAA,CAClD,EAaIsC,CAAA,EAGHC,EAAwB,IAAM,CAClC,IAAID,EAAQ,GACZ,OAAKZ,EAAA,EAAY,MAAM,OAMbY,EAAA,GALRP,EAAS,QAAS,CAChB,KAAM,QACN,QAAS/B,EAAE,wCAAwC,CAAA,CACpD,EAIIsC,CAAA,EAGHE,EAAmB,IACvBH,EAAqB,GAAKE,EAAsB,EAE5CE,EAAc,IAAM,CACpBD,KACevB,EAAA,CACf,MAAOS,IAAY,MACnB,cAAe,CAAC,GAAGV,EAAc,cAAe,CAAE,GAAGU,EAAU,EAAG,CAAA,CACnE,EACDE,EAAM,CAAE,MAAOF,EAAU,EAAE,KAAO,CAAA,IAE9BG,EAAO,MAAM,SACfR,EAASQ,EAAO,KAAK,QAASa,EAAa,MAAM,EAG/Cb,EAAO,OAAO,SAChBR,EAASQ,EAAO,MAAM,QAASa,EAAa,MAAM,EAEtD,EAGIC,EAAqB,IAAM,CAC/B,MAAMC,EAAW,CAAC,GAAG5B,EAAc,aAAa,EAAE,OAC/C6B,GAASA,EAAK,OAASA,EAAK,IAAA,EAE/B5B,EAAiB,CAAE,MAAOS,EAAA,EAAY,MAAO,cAAekB,EAAU,CAAA,EAGlEE,EAA+B,IAC/B5B,EAEAZ,EAACyC,GAAA,CACC,cAAY,+BACZ,QAASC,GAAc,UACvB,SAAWtC,GAAWc,EAA0Bd,CAAM,EACtD,WAAYgB,IAAY,YACxB,SAAWuB,GAAkB,CAClBnB,EAAA,cAAemB,EAAc,SAAU,CAAA,EAC5Cd,IACFJ,EAAS,OAAQ,CAAE,KAAM,UAAY,CAAA,EAErCC,EAAY,MAAM,CAEtB,EACA,OAAQT,EACR,gBAAiBvB,EAAE,iBAAiB,EACpC,UAAW6B,EAAO,MAAQ,QAC1B,UAAW,IACV,GAAGF,EAAS,cAAe,CAC1B,SAAU,GACV,SAAUU,CAAA,CACX,EAEA,SAAQnB,EAAA,YAAY,IAAKgC,GACxB5C,EAAC6C,GAAA,CAEC,MAAOC,GAAMpD,EAAGkD,EAAO,YAAcA,EAAO,IAAI,EAChD,QAAUG,GAAM,CACdA,EAAE,gBAAgB,EAClB7B,EAA0B,EAAK,EACtBM,EAAA,OAAQoB,EAAO,IAAK,CAC/B,EAEC,SAAME,GAAApD,EAAGkD,EAAO,YAAcA,EAAO,IAAI,CAAA,EARrCA,EAAO,IAAA,CAUf,CAAA,CAAA,EAKH5C,EAACgD,GAAA,CACC,GAAG,OACH,YAAatD,EAAE,gBAAgB,EAC/B,UAAW6B,EAAO,MAAQ,QAC1B,UAAYwB,GAAMA,EAAE,MAAQ,SAAWZ,EAAY,EAClD,GAAGd,EAAS,OAAQ,CACnB,SAAU,GACV,SAAUU,CAAA,CACX,CAAA,CAAA,EAOP,OAAAkB,EAACC,GAAA,CACC,UAAU,6BACV,cAAY,6BAEZ,SAAA,CAAClD,EAAAmD,EAAA,CAAY,UAAU,sCACrB,SAACnD,EAAAoD,EAAA,CAAK,UAAWC,EAAa,GAAK,SAAA3D,EAAE,kBAAkB,CAAE,CAAA,EAC3D,EACAM,EAACsD,GAAA,CACC,SAAQ,GACR,UAAU,mCACV,QAAQ,OACR,MAAO5D,EAAE,kCAAkC,EAC3C,UAAU,IAAA,CACZ,EACAuD,EAACE,EAAY,CAAA,UAAU,uCACrB,SAAA,CAACnD,EAAA,MAAA,CAAI,UAAU,kCACb,SAACA,EAAAoD,EAAA,CAAK,UAAWC,EAAa,GAAK,SAAA3D,EAAE,KAAK,CAAE,CAAA,EAC9C,EACCM,EAAA,MAAA,CAAI,UAAU,mCACb,SAACA,EAAAoD,EAAA,CAAK,UAAWC,EAAa,GAAK,SAAA3D,EAAE,OAAO,CAAE,CAAA,EAChD,CAAA,EACF,EACCM,EAAA,MAAA,CAAI,UAAU,kCACZ,aACH,EACCA,EAAA,MAAA,CAAI,UAAU,mCACb,WAACuD,GACC,CAAA,SAAA,CAAAvD,EAACwD,EACC,CAAA,SAAAxD,EAACgD,GAAA,CACC,GAAG,QACH,YAAatD,EAAE,kBAAkB,EACjC,UAAW6B,EAAO,OAAS,QAC3B,UAAYwB,GAAM,CACZA,EAAE,MAAQ,UACZA,EAAE,eAAe,EACLZ,IAEhB,EACC,GAAGd,EAAS,QAAS,CACpB,SAAU,GACV,SAAUY,CAAA,CACX,CAAA,CAAA,EAEL,IACCuB,EACC,CAAA,SAAAxD,EAACyD,EAAA,CACC,cAAY,0CACZ,QAAQ,UACR,OAAOC,GAAU,EAAA,EACjB,QAASvB,EACT,aAAYzC,EAAE,aAAa,CAAA,CAAA,EAE/B,CAAA,CAAA,CACF,CACF,CAAA,EACCmB,EAA2B,EAE5Bb,EAAC,MAAI,CAAA,UAAU,gBACb,SAAAA,EAAC2D,GAAA,CACC,KAAK,QACL,aAAc,GACd,QAAAhC,EACA,OAAQ,CAAC,CAAE,MAAAiC,CAAA,IACT5D,EAAC6D,GAAA,CACC,GAAG,QACH,cAAY,QACZ,MAAOnE,EAAE,aAAa,EACtB,UAAWkE,EAAM,MACjB,SAAUA,EAAM,QAAA,CAClB,CAAA,CAAA,EAGN,EACAX,EAACa,GAAY,CAAA,UAAU,0CACrB,SAAA,CAAA9D,EAACyD,EAAA,CACC,cAAY,4BACZ,QAAQ,UACR,KAAK,SACL,WAAY,CAAC/C,EAAc,cAAc,OACzC,QAASI,EAER,WAAE,QAAQ,CAAA,CACb,EACAd,EAACyD,EAAA,CACC,QAASM,EAAc,KACvB,QAAS,IAAM,CACPzC,IACae,GACrB,EAEC,WAAE,OAAO,CAAA,CACZ,CAAA,EACF,CAAA,CAAA,CAAA,CAGN,CCtPO,SAAS2B,GAA0B,CACxC,mBAAAC,EACA,sBAAAC,EACA,MAAAC,EACA,gBAAAC,EACA,mBAAAC,EACA,wBAAAC,EACA,WAAAC,EACA,WAAA/E,EACA,cAAAgF,EACA,WAAAC,EACA,cAAAC,EACA,cAAAhE,EACA,iBAAAC,EACA,QAAAgE,EACA,QAAA/D,EACA,gBAAAgE,EACA,2BAAA/D,EACA,yBAAAC,CACF,EAAmC,CAC3B,KAAA,CAAE,EAAApB,GAAMC,IACR,CAACkF,EAAWC,CAAY,EAAIhF,EAAS,EAAK,EAE1C,CAAE,UAAAiF,GAAcC,KAMhBC,EAAYF,EAAU,aAAa,EAEnCG,EAAa,IAEflF,EAACmF,EACC,CAAA,SAAAlC,EAACM,GACC,CAAA,SAAA,CAAAvD,EAACwD,EACC,CAAA,SAAAxD,EAACT,GAAA,CACC,WAAAC,EACA,SAAWA,GAAe,CACRoF,IAChBJ,EAAchF,CAAU,CAC1B,CAAA,CAAA,EAEJ,EACCA,IAAe,WAAa4F,EAAmB,EAC/C5F,IAAe,aAAe6F,EAAqB,CAAA,CACtD,CAAA,CACF,CAAA,EAIED,EAAqB,MAEtBD,EACC,CAAA,SAAAnF,EAACsF,GAAA,CACC,cAAY,qBACZ,YAAa5F,EAAE,eAAe,EAC9B,aAAYA,EAAE,QAAQ,EACtB,MAAO+E,EACP,SAAU,CAACc,EAAGC,EAAIC,IAAc,CAChBf,EAAAe,EAAU,QAAW,EAC3Bd,GACV,EACA,UAAY5B,GAAM,CACZ,GAAAA,EAAE,MAAQ,QAAS,CACrB,MAAM2C,EAAS3C,EAAE,OACjB2B,EAAcgB,EAAO,KAAK,EAClBf,GACV,CACF,EACA,QAAS,IAAM,CACbD,EAAc,EAAE,EACRC,GACV,CAAA,CAEJ,CAAA,CAAA,EAIEU,EAAuB,IAGvBpC,EAAA0C,EAAA,CAAA,SAAA,CAAA3F,EAAC4F,GAAA,CACC,cAAY,6BACZ,WAAYlG,EAAE,kBAAkB,EAChC,sBAAAwE,EACA,mBAAAD,EACA,MAAM,OAEN,SAAAjE,EAACS,GAAA,CACC,cAAAC,EACA,iBAAAC,EACA,QAAAC,EACA,2BAAAC,EACA,yBAA0B,IAAM,CACLC,IACzBoD,EAAsB,EAAK,CAC7B,CAAA,CACF,CAAA,CACF,EACAlE,EAACyD,EAAA,CACC,OAAOoC,GAAe,EAAA,EACtB,QAAQ,UACR,QAAS,IAAM,CACY/E,IACzBoD,EAAsB,EAAK,CAC7B,EACA,aAAYxE,EAAE,kBAAkB,CAAA,CAClC,CACF,CAAA,CAAA,EAIEoG,EAAmC3B,EAAM,oBAY7CnE,EAACmF,EACC,CAAA,SAAAnF,EAACG,GAAA,CACC,aAAeC,GAAW0E,EAAa1E,CAAM,EAC7C,OAASC,GACPL,EAACM,GAAA,CACC,IAAAD,EACA,WAAYwE,EACZ,QAAQ,QACR,QAAS,IAAMC,EAAa,CAACD,CAAS,EAEtC,WAACkB,GAAc,EAAA,CAAA,CACjB,EAEF,OAAQlB,EACR,0BAAyB,GAEzB,WAACrE,GACC,CAAA,SAAA,CAAAR,EAACC,EAAA,CAEC,UAAU,SACV,WAAYmE,EACZ,QAAS,IAAM,CACMC,IACnBS,EAAa,EAAK,CACpB,EAEC,WAAE,YAAY,CAAA,EARX,YASN,EAEA9E,EAACC,EAAA,CAEC,UAAU,SACV,QAAS,IAAM,CACWqE,IACxBQ,EAAa,EAAK,CACpB,EAEC,WAAE,gBAAgB,CAAA,EAPf,QAQN,CAAA,EACF,CAAA,CAEJ,CAAA,CAAA,IApDCK,EACC,CAAA,SAAAnF,EAACyD,EAAA,CACC,QAASM,EAAc,KACvB,QAASM,EACT,cAAY,kBACZ,WAAYD,EAEX,WAAE,YAAY,CAAA,CACjB,CAAA,CACF,EA8CI4B,EAEF/C,EAAA0C,EAAA,CAAA,SAAA,CAAC3F,EAAAmF,EAAA,CACC,SAACnF,EAAAyD,EAAA,CAAO,cAAY,WAAW,QAASc,EACrC,SAAA7E,EAAE,SAAS,CACd,CAAA,EACF,EACCoG,CACH,CAAA,CAAA,EAGF,OAEK7C,EAAA0C,EAAA,CAAA,SAAA,CAAWT,EAAA,EACXD,EAAYe,EAAc,IAC7B,CAAA,CAAA,CAEJ,CC9KA,MAAMC,GAAkBC,GAAoB,CACpC,KAAA,CAAE,EAAAxG,GAAMC,IACR,CAAE,MAAAwE,GAAUgC,IAClB,OAEIlD,EAAA0C,EAAA,CAAA,SAAA,CAAC1C,EAAAmD,GAAA,CAAK,GAAIC,GAAO,CAAE,MAAAlC,EAAO,GAAI+B,EAAK,GAAK,IAAK,UAAY,CAAA,EACtD,SAAA,CAAKA,EAAA,SACNlG,EAACsG,IAAU,KAAAJ,EAAY,CAAA,EACzB,EACCA,EAAK,YAAa,mBAAsB,CAAC,IAAM,QAC9ClG,EAACuG,GAAQ,CAAA,QAAS7G,EAAE,gBAAgB,EAClC,SAAAM,EAACwG,GAAA,CACC,UAAU,gBACV,GAAG,uBAAA,CAAA,EAEP,CAEJ,CAAA,CAAA,CAEJ,EAMMF,GAAY,CAAC,CAAE,KAAAJ,KAA2B,CACxC,KAAA,CAAE,EAAAxG,GAAMC,IACd,OAEKsD,EAAA0C,EAAA,CAAA,SAAA,CAAA,CAACO,EAAK,SACJlG,EAAAyG,GAAA,CAAM,MAAM,MAAM,KAAMzG,EAAC0G,GAAe,CAAA,CAAA,EACtC,SAAEhH,EAAA,UAAU,EACf,EAEDwG,EAAK,kBAAkB,UACtBlG,EAACyG,GAAM,CAAA,MAAM,SAAS,KAAOzG,EAAAwG,GAAA,EAAoB,EAC9C,SAAA9G,EAAE,iBAAiB,EACtB,CAEJ,CAAA,CAAA,CAEJ,EAEMiH,GAAkBT,GAA6B,CAC7C,KAAA,CAAE,EAAAxG,GAAMC,IACd,OAEKsD,EAAA0C,EAAA,CAAA,SAAA,CAAA,CAACO,EAAK,eACJlG,EAAAuG,GAAA,CAAQ,QAAS7G,EAAE,aAAa,EAC/B,SAACM,EAAA4G,GAAA,CAAsB,UAAU,wCAAyC,CAAA,EAC5E,EACC,IACFC,EAAiB,EAAAX,EAAK,KAAK,CAC9B,CAAA,CAAA,CAEJ,EAEO,SAASY,IAAgB,CACxB,KAAA,CAAE,YAAAC,GAAgBC,KAElB,CAAE,EAAAtH,GAAMC,IACR,CAAE,SAAAoB,EAAU,SAAAkG,CAAS,EAAIjG,GAAU,EACnC,CAAE,MAAOkG,EAAW,oBAAqB/C,CAAA,EAAUgC,IACnDgB,EAAWC,KACX,CAACC,EAAaC,CAAc,EAAIxH,EAAsB,CAAE,CAAA,EACxD,CAAC2E,EAAYC,CAAa,EAAI5E,EAAS,EAAE,EACzC,CAACyH,EAAcC,CAAe,EAAI1H,EAA+B,CAAE,CAAA,EACnE,CAACN,EAAYgF,CAAa,EAAI1E,EAAqB,SAAS,EAC5D,CAACmE,EAAoBC,CAAqB,EAAIpE,EAAS,EAAK,EAC5D,CAACY,EAAeC,CAAgB,EAAIb,EAAqB,CAC7D,MAAO,GACP,cAAe,CAAC,CAAA,CACjB,EACK,CAACc,EAAS6G,CAAU,EAAI3H,EAA4B,CAAE,CAAA,EACtD,CAAC4H,EAAOC,CAAQ,EAAI7H,EAAS,EAAE,EAE/B,CAAC8H,EAAKC,CAAM,EAAI/H,EAAS,CAAC,EAC1B6E,EAAU,IAAMkD,EAAOD,EAAM,CAAC,EAEpCE,GACE,SAAY,CACN,GAAA,CACK,OAAA,MAAM,QAAQ,IAAI,CACvBC,GAAehB,CAAW,EAC1BA,EAAY,MAAM,WAAW,CAAA,CAC9B,CAAA,MACK,CACN,MAAO,CAAC,CAAA,EAAI,CAAA,CAAE,CAChB,CACF,EACA,CAAC,CAACM,EAAazG,CAAO,IAAM,CAC1B0G,EAAeD,CAAW,EAC1BI,EAAW7G,CAAO,CACpB,EACA,CAAC,CAAA,EAGH,MAAMoH,EAAS,MAAOC,EAAgBC,EAAcC,KAAoB,CACtE,MAAMC,EAAwD,CAC5D,MAAAH,EACA,IAAAC,EACA,EAAGR,EACH,MAAOhH,EAAc,KAAA,EAGjB2H,EAAcF,IAAU1D,GAAc,GAK5C,GAJI4D,IACFD,EAAO,OAASC,GAGd,CAACC,GAAa,EAAEF,EAAO,QAAUA,EAAO,GAC1C,MAAO,GAGL,GAAA,CACK,OAAA,MAAMG,GAAUxB,EAAa,CAClC,oBAAqB,GACrB,GAAGqB,CAAA,CACJ,QACMI,GAAO,CACd,OAAInB,EAAY,4BACdJ,EAAS,2BAA4BuB,EAAK,EAE1CvB,EAAS,oBAAqBuB,EAAK,EAE9B,EACT,CAAA,EAGI,CAAClE,EAAyBmE,CAAkB,EAAIC,GAAiB,CACrE,SAAU,iBACV,WAAY,qBACZ,oBAAqB,SACrB,UAAW,SAAY,CACjB,GAAA,CACI,MAAA3B,EAAY,gBAAgB,SAC1BpC,IACR5D,EAASrB,EAAE,oBAAoB,EAAG0C,EAAa,OAAO,QAC/CoG,EAAO,CACdvB,EAAS,mBAAoBuB,CAAK,CACpC,CACF,CAAA,CACD,EAEK,CAACnE,EAAoBsE,CAAa,EAAID,GAAiB,CAC3D,SAAU,qBACV,WAAYhJ,EAAE,sBAAuB,CAAE,MAAO6H,EAAa,OAAQ,EACnE,oBAAqB,SACrB,sBAAuBxD,EAAc,OACrC,UAAW,SAAY,CACjB,GAAA,CACF,UAAWmC,KAAQqB,EACjB,MAAMR,EAAY,MAAM,IAAI,CAAE,GAAIb,EAAK,GAAK,EAE9CsB,EAAgB,CAAE,CAAA,EACF5C,IAChB7D,EAASrB,EAAE,oBAAoB,EAAG0C,EAAa,OAAO,QAC/CoG,EAAO,CACdvB,EAAS,mBAAoBuB,CAAK,CACpC,CACF,CAAA,CACD,EAEKjE,EAAa,IAAM4C,EAASyB,GAAU,CAAE,MAAO1B,CAAW,CAAA,CAAC,EAE7D,GAAA,CAACG,GAAe,CAAClD,EACnB,SAAQ0E,GAAgB,CAAA,CAAA,EAIpB,MAAAP,EAAY,CAACjB,EAAY,4BAEzBzC,EAAkB,IAAM,CAC5BjE,EAAiB,CAAE,MAAO,GAAO,cAAe,CAAA,CAAI,CAAA,EACpD+D,EAAc,EAAE,EAChBiD,EAAS,EAAE,EACHhD,GAAA,EAGJmE,GAAqBC,GAClBA,EAAQ,cACZ,IAAKjH,GAAW,GAAGA,EAAO,IAAI,IAAIA,EAAO,KAAK,EAAE,EAChD,KAAK,GAAG,EAGPhB,GAA2B,IAAM,CAC/B,MAAAkI,EAAaF,GAAkBpI,CAAa,EAClDiH,EAASqB,CAAU,EACXrE,GAAA,EAGJ9D,GAA6B,IAE9Bb,EAAAiJ,GAAA,CACE,SAAcvI,EAAA,cAAc,OAAS,GACpCV,EAAA2F,EAAA,CACG,SAAO,OAAA,OAAOjF,EAAc,aAAa,EAAE,IAAKwI,GAE7ClJ,EAACmJ,GAAA,CACC,UAAU,8BACV,cAAY,oCAEZ,aACED,EAAM,YAAY,OAASA,EAAM,YAAcA,EAAM,KAEvD,WAAU,GACV,QAAUE,GAAU,CAClBA,EAAM,gBAAgB,EAKtB,MAAMC,EAAS,CACb,cAJe,CAAC,GAAG3I,EAAc,aAAa,EAAE,OAC/C6B,GAASA,EAAK,OAAS2G,EAAM,IAAA,EAI9B,MAAOxI,EAAc,KAAA,EAGvBC,EAAiB0I,CAAM,EACd1B,EAAAmB,GAAkBO,CAAM,CAAC,EAC1B1E,GACV,EAEA,WAAC2E,GAAsB,CAAA,WAAU,GAC9B,SAAMJ,EAAA,OADEA,EAAM,IAEjB,CAAA,EAvBKA,EAAM,IAAA,CA0BhB,EACH,CAEJ,CAAA,EAIEK,GAAU,IAEZvJ,EAACgE,GAAA,CACC,mBAAAC,EACA,sBAAAC,EACA,MAAAC,EACA,gBAAiBoD,EAAa,SAAW,EACzC,mBAAAlD,EACA,wBAAAC,EACA,WAAAC,EACA,WAAA/E,EACA,cAAAgF,EACA,WAAAC,EACA,cAAAC,EACA,cAAAhE,EACA,iBAAAC,EACA,QAAAgE,EACA,QAAA/D,EACA,gBAAAgE,EACA,2BAAA/D,GACA,yBAAAC,EAAA,CAAA,EAKA0I,GAAa,IAAM,CACnB,GAAC9I,EAAc,cAAc,OAI/B,OAAAuC,EAAC,MAAI,CAAA,UAAU,wCACb,SAAA,CAACjD,EAAAmF,EAAA,CAAa,YAA6B,CAAA,CAAA,IAC1CA,EACC,CAAA,SAAAnF,EAACyD,EAAA,CACC,QAAQ,OACR,QAAS,IAAM,CACGmB,GAClB,EAEC,WAAE,iBAAiB,CAAA,CAAA,EAExB,CACF,CAAA,CAAA,CAAA,EAIJ,OAEI3B,EAAA0C,EAAA,CAAA,SAAA,CAAA3F,EAAC2I,EAAc,EAAA,IACdF,EAAmB,EAAA,EACpBzI,EAACyJ,GAAA,CACC,YACEhF,IAAe,IAAM/D,EAAc,cAAc,SAAW,EAG9D,OAAAsH,EACA,YAAW,GACX,aAAa,aACb,aAAY,GACZ,SAAW0B,GAA+BlC,EAAgB,CAAC,GAAGkC,CAAI,CAAC,EACnE,WACGpB,EAYCtI,EAAC2J,GAAA,CACC,QAASjK,EAAE,cAAc,EACzB,aAAcA,EAAE,mBAAmB,EACnC,kBAAmBA,EAAE,eAAe,EACpC,gBAAiB6E,CAAA,CACnB,EAfEtB,EAAA0C,EAAA,CAAA,SAAA,CAAA3F,EAAC4J,GACC,CAAA,SAAA5J,EAAC6J,GAAgB,CAAA,SAAAN,IAAU,CAAA,EAC7B,IACCO,GAAW,CAAA,cAAY,cAAc,QAAQ,KAC5C,SAAC9J,EAAAmD,EAAA,CAAY,UAAU,uBACrB,WAACC,EAAM,CAAA,SAAA1D,EAAE,0BAA0B,CAAA,CAAE,CACvC,CAAA,EACF,CAAA,CAAA,CACF,EAUJ,YAAa6J,GAAQ,EACrB,WAAYC,GAAW,EACvB,eAAiBO,GAAsB,CACrC,MAAM7D,EAA2B6D,EAAQ,KACzC,OAAK7D,EAAK,QAAQ,OAEX,CACL,CACE,MAAOxG,EAAE,QAAQ,EACjB,QAAS,IAAM,CACG8H,EAAA,CAACtB,CAAI,CAAC,EACH7B,GACrB,CACF,CAAA,EAT+B,CAAA,CAWnC,EACA,QAAS,CACP,CACE,KAAM,WACN,WAAY,WACZ,aAAc4B,EAChB,EACA,CACE,KAAM,QACN,WAAY,QACZ,aAAcU,EAChB,EACA,CACE,KAAM,WACN,WAAY,WACZ,eAAgB,CAACE,GAAgB,CACnC,EACA,CACE,KAAM,YACN,WAAY,YACZ,eAAgB,CAACA,GAAgB,CACnC,CACF,CAAA,EAhEKe,CAiEP,CACF,CAAA,CAAA,CAEJ,CC5YA,SAAwBoC,IAAe,CAC/B,KAAA,CAAE,EAAAtK,GAAMC,IACR,CAAE,MAAOuH,CAAU,EAAIf,EAAS,EAChC,CAAE,UAAApB,GAAcC,KAGhBiF,EAFmBC,KAGNC,GAAQ,qBAAqB,GAC9CpF,EAAU,uBAAwB,eAAgB,gBAAgB,EAE9DqF,EAAUC,GACdC,GACEC,GAAQ,CACN,MAAOrD,EACP,IAAAmD,CAAA,CACD,CAAA,EAGCG,EAAUJ,EAAO,MAAM,EACvBK,EAAiBL,EAAO,aAAa,EAE3C,OAEInH,EAAA0C,EAAA,CAAA,SAAA,CAAA3F,EAAC0K,GAAA,CACC,SAAS,aACT,OAAO,eACP,QAASC,GAAS,SAClB,QAAS,EAAA,CACX,EACA3K,EAAC4K,GAAA,CACC,cAAY,aACZ,QAAQ,QACR,UAAU,cAEV,SAAA3H,EAAC4H,GAAA,CACC,cAAY,YACZ,gBAAiBN,GAAQ,CACvB,MAAOrD,EACP,IAAK,MAAA,CACN,EACD,MAAK,GACL,aAAY,GAEZ,SAAA,CAAAlH,EAAC8K,GAAA,CACC,GAAG,OACH,cAAY,UACZ,MAAO9K,EAAC+K,GAAc,CAAA,SAAArL,EAAE,UAAU,EAAE,EACnC,GAAG8K,EAEJ,WAAC1D,GAAc,EAAA,CAAA,CACjB,EACCmD,GACCjK,EAAC8K,GAAA,CACC,GAAG,cACH,cAAY,iBACZ,MAAO9K,EAAC+K,GAAc,CAAA,SAAArL,EAAE,aAAa,EAAE,EACtC,GAAG+K,EAEJ,SAAAzK,EAACgL,GAAe,CAAA,KAAK,OAAQ,CAAA,CAAA,CAC/B,CAAA,CAAA,CAEJ,CAAA,CACF,CACF,CAAA,CAAA,CAEJ"}