import{jsxs as d,Fragment as v,jsx as e}from"react/jsx-runtime";import{u as g,a as h,Y as F,ax as P,J as S,K as b,a4 as k,b as D,dy as E,j as O,$ as x,d as A,P as w,m as L,A as K,f,L as U,dK as V,p as $,dL as j}from"./main-C047jAp3.js";import{F as J}from"./FormAccess-CEFqBG2E.js";import{V as T}from"./ViewHeader-Y2Z8ln-o.js";import{D as G,O as H,a as N}from"./OIDCGeneralSettings-DAzW3JuL.js";import{J as z}from"./JsonFileUpload-Dej5GsDK.js";import{D as B}from"./DiscoveryEndpointField-CyQJEKKi.js";import"react";import"react-dom";import"./copy-icon-D1BxihC2.js";import"./SwitchControl-87mhceN2.js";/* empty css                           */import"./ExpandableSection-CzJlltxl.js";import"./ClientIdSecret-D8YFRWLH.js";import"./RedirectUrl-BKPgDV71.js";import"./FileUploadForm-BSqaRKUe.js";import"./FileUpload-2t3HfN2b.js";import"./CodeEditor--AHMF_Ho.js";const _=()=>{const{adminClient:l}=g(),{t}=h(),m="oidc",{setValue:p,setError:c,clearErrors:n,formState:{errors:o}}=F(),u=r=>{Object.keys(r).map(i=>p(`config.${i}`,r[i]))},y=async r=>{if(n("discoveryError"),!r)return;const i=new FormData;i.append("providerId",m),i.append("file",new Blob([JSON.stringify(r)]));try{const a=await l.identityProviders.importFromUrl(i);u(a)}catch(a){c("discoveryError",{type:"manual",message:a.message})}};return d(v,{children:[e(P,{headingLevel:"h2",size:"xl",className:"kc-form-panel__title",children:t("oidcSettings")}),e(B,{id:"oidc",fileUpload:d(S,{label:t("importConfig"),fieldId:"kc-import-config",labelIcon:e(b,{helpText:t("importConfigHelp"),fieldLabelId:"importConfig"}),children:[e(z,{id:"kc-import-config",helpText:t("identity=providers-help:jsonFileUpload"),hideDefaultPreview:!0,unWrap:!0,validated:o.discoveryError?"error":"default",onChange:r=>y(r)}),o.discoveryError&&e(k,{message:o.discoveryError.message})]}),children:r=>e(G,{readOnly:r})})]})};function le(){const{adminClient:l}=g(),{t}=h(),m=D(),{pathname:p}=E(),c=p.includes("keycloak-oidc"),n=`${c?"keycloak-":""}oidc`,o=O({defaultValues:{alias:n},mode:"onChange"}),{handleSubmit:u,formState:{isDirty:y}}=o,{addAlert:r,addError:i}=x(),{realm:a}=A(),I=async s=>{delete s.discoveryEndpoint;try{await l.identityProviders.create({...s,providerId:n}),r(t("createIdentityProviderSuccess"),$.success),m(j({realm:a,providerId:n,alias:s.alias,tab:"settings"}))}catch(C){i("createIdentityProviderError",C)}};return d(v,{children:[e(T,{titleKey:t(c?"addKeycloakOpenIdProvider":"addOpenIdProvider")}),e(w,{variant:"light",children:e(L,{...o,children:d(J,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:u(I),children:[e(H,{}),e(_,{}),e(N,{}),d(K,{children:[e(f,{isDisabled:!y,variant:"primary",type:"submit","data-testid":"createProvider",children:t("add")}),e(f,{variant:"link","data-testid":"cancel",component:s=>e(U,{...s,to:V({realm:a})}),children:t("cancel")})]})]})})})]})}export{le as default};
//# sourceMappingURL=AddOpenIdConnect-ojDMjkgW.js.map
